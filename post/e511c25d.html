

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="firtree">
  <meta name="keywords" content="">
  
    <meta name="description" content="Linux的简单操作，巨基础！！！">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux笔记">
<meta property="og:url" content="http://example.com/post/e511c25d.html">
<meta property="og:site_name" content="firtree">
<meta property="og:description" content="Linux的简单操作，巨基础！！！">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-04-08T10:07:59.000Z">
<meta property="article:modified_time" content="2023-06-08T10:20:21.792Z">
<meta property="article:author" content="firtree">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Linux笔记 - firtree</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Firtree</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>archive</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>category</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>tag</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>about</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/photos/055.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Linux笔记"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-04-08 18:07" pubdate>
          2023年4月8日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          32k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          268 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Linux笔记</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="1-网络连接三种模式"><a href="#1-网络连接三种模式" class="headerlink" title="1 网络连接三种模式"></a>1 网络连接三种模式</h1><ul>
<li>桥接模式</li>
</ul>
<p>虚拟主机的 ip 和本地主机 ip 可以互相访问，虚拟机也可以访问互联网，虚拟机相当于互联网中的一台主机，在桥接模式下，虚拟机 ip 地址需要与主机在同一个网段，如果需要联网，则网关与 DNS 需要与主机网卡一致</p>
<p>虚拟系统可以和外部系统相互通讯，但是容易造成 IP 冲突</p>
 <br>

<ul>
<li>NAP模式</li>
</ul>
<p>虚拟机可以访问互联网和本地（物理）主机，但本地主机不可以访问虚拟机。</p>
<p>网络地址转换模式。虚拟系统可以和外部（间接）联系，不会造成 IP 冲突</p>
 <br>

<ul>
<li>主机模式</li>
</ul>
<p>独立系统，不与外部发生联系</p>
<p>虚拟机不可以访问本地主机互联网，发现虚拟机和本地（物理）主机网络是隔离的</p>
<br>

<h1 id="2-linux目录结构"><a href="#2-Linux目录结构" class="headerlink" title="2 Linux目录结构"></a>2 Linux目录结构</h1><p>linux 的文件系统是采用级层式的树状目录结构，在此结构的最上层是根目录 “&#x2F;“，然后再此目录下创建其他的目录</p>
<p><strong>可以说，Linux 中的一切都是文件，具体的目录结构有：</strong></p>
<ul>
<li>&#x2F;bin</li>
</ul>
<p>是 Binary 的缩写，这个目录存放着最经常使用的命令</p>
<ul>
<li>&#x2F;sbin</li>
</ul>
<p>s就是 Super User 的意思，这里存放的是系统管理员使用的系统管理程序</p>
<ul>
<li>&#x2F;home</li>
</ul>
<p>存放普通用户的主目录，在 Linux 中每个用户都有一个自己的目录，一般该目录名是以用户的账号命名</p>
<ul>
<li>&#x2F;root</li>
</ul>
<p>该目录为系统管理员，也称作超级权限者的用户主目录</p>
<ul>
<li>&#x2F;etc</li>
</ul>
<p>所有的系统管理所需要的配置文件和子目录</p>
<ul>
<li>&#x2F;usr</li>
</ul>
<p>这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似与 windows 下的 program files 目录</p>
<ul>
<li>&#x2F;boot</li>
</ul>
<p>存放的是启动 Linux 时使用的一些核心文件，包括一些连接文件以及镜像文件</p>
<ul>
<li>&#x2F;proc</li>
</ul>
<p>这个目录是一个虛拟的目录，它是系统内存的映射，访问这个目录来获取系统信息</p>
<ul>
<li>&#x2F;srv</li>
</ul>
<p>service 缩写，该目录存放一些服务启动之后需要提取的数据</p>
<ul>
<li>&#x2F;sys</li>
</ul>
<p>这是 linux2.6 内核的一个很大的变化，该目录下安装了2.6内核中新出现的一个文件系统 sysfs</p>
<ul>
<li>&#x2F;tmp</li>
</ul>
<p>这个目录是用来存放一些临时文件的</p>
<ul>
<li>&#x2F; dev</li>
</ul>
<p>类似于 windows 的设备管理器，把所有的硬件用文件的形式存储</p>
<ul>
<li>&#x2F;media</li>
</ul>
<p>linux 系统会自动识别一些设备，例如U盘、光驱等等，当识别后，linux 会把识别的设备挂载到这个目录下</p>
<ul>
<li>&#x2F;mnt</li>
</ul>
<p>系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载在 &#x2F;mnt&#x2F; 上，然后进入该目录就可以查看里的内容了</p>
<ul>
<li>&#x2F;opt</li>
</ul>
<p>这是给主机额外安装软件所摆放的目录，如安装 ORACLE 数据库就可放到该目录下。默认为空</p>
<ul>
<li>&#x2F;lib</li>
</ul>
<p>系统开机所需要最基本的动态连接共享库，其作用类似于 Windows 里的 DLL 文件。几乎所有的应用程序都需要用到这些共享库</p>
<ul>
<li>&#x2F;lost + found</li>
</ul>
<p>这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件</p>
<ul>
<li>&#x2F;usr&#x2F;local</li>
</ul>
<p>这是另一个给主机额外安装软件所安装的目录。一般是通过编译源码方式安装的程序</p>
<ul>
<li>&#x2F;var</li>
</ul>
<p>这个目录中存放着在不断扩充着的东西，习惯将经常被修改的目录放在这个目录下。包括各种日志文件<br><br></p>
<h1 id="3-vim-x2f-vi"><a href="#3-vim-x2F-vi" class="headerlink" title="3 vim &#x2F; vi"></a>3 vim &#x2F; vi</h1><p>Linux 系统会内置 vi 文本编辑器<br>Vim 具有程序编辑的能力，可以看做是 Vi 的增强版本，可以主动的以字体颜色辨别语法的正确性，方便程序设计。代码补全、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用</p>
<br>

<h3 id="常用的三种模式"><a href="#常用的三种模式" class="headerlink" title="常用的三种模式"></a>常用的三种模式</h3><ol>
<li>正常模式</li>
</ol>
<p>以 vim 打开一个档案就直接进入一般模式（默认模式）。在这个模式中，可以使用 [上下左右] 按键来移动光标，可以使用 [删除字符] 或 [删除整行] 来处理档案内容，也可以使用复制、粘贴来处理文件数据</p>
<ol start="2">
<li>插入模式</li>
</ol>
<p>按下 i，I，o，O，a，A，r，R 等任何一个字母之后才会进入编辑模式，一般来说按 i 即可</p>
<ol start="3">
<li>命令行模式</li>
</ol>
<p>先 esc 再输入 : 就进入命令行模式。在这个模式当中，可以提供你相关指令。完成读取、存盘、替换、离开 vim、显示行号等的动作则是在此模式中达成的</p>
<br>

<p>命令行模式下的常用指令有</p>
<p>:wq         – 保存并退出</p>
<p>:q            – 退出</p>
<p>:q!           – 强制退出不保存</p>
<br>

<table>
<thead>
<tr>
<th>常用的快捷键</th>
</tr>
</thead>
<tbody><tr>
<td>1.  拷贝当前行 yy，拷贝当前行向下的5行 5yy，并粘贴（输入 p ）</td>
</tr>
<tr>
<td>2.  删除当前行 dd，删除当前行向下的5行 5dd</td>
</tr>
<tr>
<td>3.  在文件中查找某个单词 [命令行模式下  &#x2F;  关键字，回车查找，输入 n 就是查找下一个]</td>
</tr>
<tr>
<td>4.  设置文件的行号，取消文件的行号 [命令行模式下  :et  nu  和  :set  nonu]</td>
</tr>
<tr>
<td>5.  编辑 &#x2F;etc&#x2F;profile 文件，使用快捷键到该文档的最末行 [G] 和最首行 [gg]</td>
</tr>
<tr>
<td>6.  在一个文件中输入 “hello” 然后又撤销这个动作	[u]</td>
</tr>
</tbody></table>
<br>

<h1 id="4-基本指令"><a href="#4-基本指令" class="headerlink" title="4 基本指令"></a>4 基本指令</h1><h2 id="41-关机-amp-重启"><a href="#4-1-关机-amp-重启" class="headerlink" title="4.1 关机 &amp; 重启"></a>4.1 关机 &amp; 重启</h2><p>shutdown  -h  now           立即关机</p>
<p>shutdown  -h  1                 一分钟后关机</p>
<p>shutdown  -r  now            立即重启</p>
<p>halt                 关机</p>
<p>reboot            重启</p>
<p>sync                把内存的数据同步到磁盘</p>
<br>

<p>PS：</p>
<ol>
<li>不管是重启系统还是关闭系统，首先要运行 sync 命令，把内存中的数据写到磁盘中</li>
<li>目前的 shutdown  &#x2F;  reboot  &#x2F;  halt 等命令均已经在关机前进行了 sync，但建议谨慎</li>
</ol>
<br>

<h2 id="42-切换用户"><a href="#4-2-切换用户" class="headerlink" title="4.2 切换用户"></a>4.2 切换用户</h2><ul>
<li>登录时尽量少用 root 帐号登录，因为它是系统管理员，有最大的权限，避免操作失误</li>
<li>可以利用普通用户登录，登录后再用 “su  -  用户名” 命令来切换成系统管理员身份</li>
<li>输入 logout 即可注销用户</li>
</ul>
<br>

<ul>
<li>logout 注销指令在 图形运行级别 无效，在 运行级别3 下才有效</li>
</ul>
<p>如果以普通用户 tom 登陆，再切换为 root。此时 logout 会切换为 tom，再次 logout 则直接登出</p>
<br>

<h2 id="43-管理用户"><a href="#4-3-管理用户" class="headerlink" title="4.3 管理用户"></a>4.3 管理用户</h2><p>Linux 系统是一个多用户多任务的操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。</p>
<br>

<h3 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h3><p>基本语法：useradd   用户名<br>PS：</p>
<ul>
<li>当创建用户成功后，会自动的创建和用户同名的家目录</li>
<li>也可以通过 useradd  -d 指定目录新的用户名，给新创建的用户指定家目录</li>
</ul>
<p>eg.  在创建家目录时直接指定家目录			useradd   -d   &#x2F;home&#x2F;test   king</p>
<br>

<h3 id="指定-x2f-修改密码"><a href="#指定-x2F-修改密码" class="headerlink" title="指定 &#x2F; 修改密码"></a>指定 &#x2F; 修改密码</h3><p>基本语法：passwd   用户名</p>
<br>

<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><p>基本语法：userdel   用户名</p>
<ul>
<li><p>删除用户 milan，但是保留家目录            userdel  milan</p>
</li>
<li><p>删除用户及其家目录                                   userdel  -r  milan</p>
</li>
</ul>
<p>PS：一般情况下家目录都不删，慎重删除</p>
<br>

<h3 id="查询用户信息"><a href="#查询用户信息" class="headerlink" title="查询用户信息"></a>查询用户信息</h3><p>基本语法：id   用户名</p>
<br>

<br>

<h3 id="切换用户"><a href="#切换用户" class="headerlink" title="切换用户"></a>切换用户</h3><p>基本语法：su   -   切换用户名</p>
<p>在操作 Linux 中，如果当前用户的权限不够，可以通过 su  -  指令，切换到高权限用户，比如 root</p>
<p>PS：</p>
<ul>
<li>从权限高的用户切换到权限低的用户，不需要输入密码，反之需要</li>
<li>当需要返回到原来用户时，使用 exit &#x2F; logout 指令</li>
</ul>
<br>

<h3 id="查看当前用户"><a href="#查看当前用户" class="headerlink" title="查看当前用户"></a>查看当前用户</h3><p>基本语法：whoami</p>
<br>

<h2 id="44-管理用户组"><a href="#4-4-管理用户组" class="headerlink" title="4.4 管理用户组"></a>4.4 管理用户组</h2><p>类似于角色，系统可以对有共性的多个用户进行统一的管理</p>
<ul>
<li><p>新增组           groupadd   组名</p>
</li>
<li><p>删除组           groupdel     组名</p>
</li>
<li><p>增加用户时直接加上组                 useradd   -g   用户组   用户名</p>
</li>
</ul>
<p>当添加一个用户但是没有指定他的组时，会默认的创建一个与它同名的组，将该用户添加到这个组内</p>
<br>

<p>也可以在添加用户时直接指定组</p>
<p>eg. 增加一个用户 zwj，直接将他指定到 wudang</p>
<ol>
<li>groupadd   wudang</li>
<li>useradd   -g   wudang   zwj</li>
</ol>
<br>

<p>修改用户的组</p>
<p>基本语法：usermod   -g   [新组名]   [用户名]</p>
<p>eg.  把 zwh 再转移到 mojiao中</p>
<ol>
<li>groupadd   mojiao</li>
<li>usermod   -g   mojiao   zwj</li>
</ol>
<br>

<p>用户组的相关文件</p>
<p>（1）&#x2F;etc&#x2F;passwd 文件</p>
<p>用户（user）的配置文件，记录用户的各种信息</p>
<p>每行的含义</p>
<p>用户名：口令：用户标识号：组标识号：注释性描述：主目录：登录Shell</p>
<br>

<p>（2）&#x2F;etc&#x2F;shadow 文件</p>
<p>口令的配置文件</p>
<p>每行的含义</p>
<p>登录名：加密口令：最后一次修改时间：最小时间间隔：最大时间间隔：警告时间：不活动时间：失效时间：标志</p>
<br>

<p>（3）&#x2F;etc&#x2F;group 文件</p>
<p>组（group）的配置文件，记录 Linux 包含的组的信息</p>
<p>每行含义</p>
<p>组名：口令：组标识号：组内用户列表</p>
<br>

<h1 id="5-实用指令"><a href="#5-实用指令" class="headerlink" title="5 实用指令"></a>5 实用指令</h1><h2 id="51-找回root密码"><a href="#5-1-找回root密码" class="headerlink" title="5.1 找回root密码"></a>5.1 找回root密码</h2><p>如何找回root密码？ </p>
<p>（1）首先，启动系统，进入开机界面，在界面中按 ‘e’ 进入编辑界面（要快</p>
<p>（2）进入编辑界面，使用键盘上的上下键把光标往下移动，找到以 “linux16” 开头内容所在的行数，在行的最后输入：init&#x3D;&#x2F;bin&#x2F;sh</p>
<p>（3）输入完成后直接快捷键 ctrl+x，进入单用户模式</p>
<p>（4）接着在光标闪烁的位置输入：mount   -o   remount,rw&#x2F;  再按回车确定</p>
<p>（5）在新的一行后面输入：passwd，完成后回车，输入密码后再次确认密码即可，修改密码后，会出现passwd… 的格式，则说明密码修改成功</p>
<p>（6）再在鼠标闪烁的位置输入：exec   &#x2F;sbin&#x2F;init 完成后按回车等待系统修改密码（时间较长），接着系统重启新密码生效</p>
<br>

<h2 id="52-帮助指令"><a href="#5-2-帮助指令" class="headerlink" title="5.2 帮助指令"></a>5.2 帮助指令</h2><h3 id="man-获得帮助信息"><a href="#man-–-获得帮助信息" class="headerlink" title="man – 获得帮助信息"></a>man – 获得帮助信息</h3><p>基本语法：man   [命令或者配置文件]</p>
<p>按小写 q 退出</p>
<p>eg.  查看 ls 命令的帮助信息                 man   ls</p>
<p>ls 的常用选项：</p>
<p>-a    列出所有文件，包括以 ‘.’ 开头的隐含文件</p>
<p>-l    表示单列输出</p>
<ul>
<li><p>各选项可以混合使用，没有顺序要求      ls   -a   -l 表示单列显示所有文件</p>
</li>
<li><p>也可以指定要操作的目录                         ls   &#x2F;root   -a   -l</p>
</li>
</ul>
 <br>

<h3 id="help-获得shell内置命令的帮助信息"><a href="#help-–-获得shell内置命令的帮助信息" class="headerlink" title="help – 获得shell内置命令的帮助信息"></a>help – 获得shell内置命令的帮助信息</h3><p>基本语法：help  [命令]</p>
<p>eg.  查询 cd 命令的帮助信息               help   cd</p>
<br>

<h2 id="53-文件目录"><a href="#5-3-文件目录" class="headerlink" title="5.3 文件目录"></a>5.3 文件目录</h2><h3 id="pwd-指令-显示当前工作目录的绝对路径"><a href="#pwd-指令-–-显示当前工作目录的绝对路径" class="headerlink" title="pwd 指令 – 显示当前工作目录的绝对路径"></a>pwd 指令 – 显示当前工作目录的绝对路径</h3><br>

<br>

<h3 id="cd-指令-切换到指定的目录下"><a href="#cd-指令-–-切换到指定的目录下" class="headerlink" title="cd 指令 – 切换到指定的目录下"></a>cd 指令 – 切换到指定的目录下</h3><p>cd  ~ 或者 cd     回到当前登录用户的家目录</p>
<p>cd  ..                   回到当前目录的上一级</p>
 <br>

 <br>

<h3 id="mkdir-创建目录"><a href="#mkdir-–-创建目录" class="headerlink" title="mkdir – 创建目录"></a>mkdir – 创建目录</h3><p>基本语法：mkdir   [选项]</p>
<p>-p    表示创建多级目录</p>
<p>eg.</p>
<ol>
<li>创建一个目录     mkdir   &#x2F;home&#x2F;tiger</li>
<li>创建多级目录     mkdir   -p   &#x2F;home&#x2F;animal&#x2F;tiger</li>
</ol>
<br>

<br>

<h3 id="rmdir-删除空目录"><a href="#rmdir-–-删除空目录" class="headerlink" title="rmdir – 删除空目录"></a>rmdir – 删除空目录</h3><p>基本语法：rmdir   [选项]</p>
<p>PS:</p>
<ol>
<li>rmdir 删除的是空目录，如果目录下有内容是不可删除</li>
<li>如果想要删除非空目录，则需要使用 rm  -rf 删除 (谨慎</li>
</ol>
<p>eg.  删除一个目录               rmdir   &#x2F;home&#x2F;dog</p>
 <br>

 <br>

<h3 id="touch-创建一个空文件"><a href="#touch-–-创建一个空文件" class="headerlink" title="touch – 创建一个空文件"></a>touch – 创建一个空文件</h3><p>基本语法：touch   [文件名称]</p>
<p>eg.  在 &#x2F;home 目录下，创建一个空文件 hello.txt                touch   &#x2F;home   hello.txt</p>
 <br>

<br>

<h3 id="cp-拷贝文件到指定的目录下"><a href="#cp-–-拷贝文件到指定的目录下" class="headerlink" title="cp – 拷贝文件到指定的目录下"></a>cp – 拷贝文件到指定的目录下</h3><p>基本语法：cp   [选项]   source   dest</p>
<p>常用选项：</p>
<p>-r    递归复制整个文件夹</p>
<p>eg.</p>
<ol>
<li><p>将 &#x2F;home&#x2F;hello.txt 拷贝到 &#x2F;home&#x2F;bbb 目录下</p>
<ul>
<li>cp   &#x2F;home&#x2F;hello.txt   &#x2F;home&#x2F;bbb</li>
</ul>
</li>
<li><p>将 &#x2F;home&#x2F;bbb 整个文件夹拷贝到 &#x2F;opt</p>
<ul>
<li>cp   -r   &#x2F;home&#x2F;bbb   &#x2F;opt</li>
</ul>
</li>
</ol>
<p>PS：强制覆盖不提醒 		\cp   -r   &#x2F;home&#x2F;bbb   &#x2F;opt</p>
<br>

 <br>

<h3 id="rm-移除文件或者目录"><a href="#rm-–-移除文件或者目录" class="headerlink" title="rm – 移除文件或者目录"></a>rm – 移除文件或者目录</h3><p>基本语法：rm   [选项]</p>
<p>常用选项：</p>
<p>-r    递归删除整个文件夹</p>
<p>-f    强制删除不提示</p>
 <br>

 <br>

<h3 id="mv-移动文件与目录或者重命名"><a href="#mv-–-移动文件与目录或者重命名" class="headerlink" title="mv –  移动文件与目录或者重命名"></a>mv –  移动文件与目录或者重命名</h3><p>基本语法：</p>
<ul>
<li>mv   [文件或目录]   [文件或目录]               移动文件</li>
<li>mv   oldNameFile   newNameFile            重命名</li>
</ul>
 <br>

 <br>

<h3 id="cat-查看文件内容"><a href="#cat-–-查看文件内容" class="headerlink" title="cat – 查看文件内容"></a>cat – 查看文件内容</h3><p>基本语法：cat   [选项]   要查看的文件</p>
<p>常用选项：</p>
<p>-n    显示行号</p>
<p>eg.  查看 hello.txt 并显示行号              cat   -n   hello.txt</p>
<p>PS：cat 只能浏览文件并不能修改，为了方便一般会带上管道命令  |  more</p>
<p>（管道命令：将处理的结果交给下一个命令，即一种组合使用）</p>
 <br>

 <br>

<h3 id="more-以全屏的方式按页显示文本的内容"><a href="#more-–-以全屏的方式按页显示文本的内容" class="headerlink" title="more – 以全屏的方式按页显示文本的内容"></a>more – 以全屏的方式按页显示文本的内容</h3><p>是一个基于 VI 编辑器 的文本过滤器，内置了若干的快捷键</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>空格</td>
<td>向下翻一页</td>
</tr>
<tr>
<td>Enter</td>
<td>向下翻一行</td>
</tr>
<tr>
<td>q</td>
<td>离开，不再显示内容</td>
</tr>
<tr>
<td>Ctrl + F</td>
<td>向下滚动一屏</td>
</tr>
<tr>
<td>Ctrl + B</td>
<td>返回上一屏</td>
</tr>
<tr>
<td>&#x3D;</td>
<td>输出当前行的行号</td>
</tr>
<tr>
<td>:f</td>
<td>输出文件名和当前行的行号</td>
</tr>
</tbody></table>
<br>

<br>

<h3 id="less-分屏查看文件内容"><a href="#less-–-分屏查看文件内容" class="headerlink" title="less – 分屏查看文件内容"></a>less – 分屏查看文件内容</h3><p>它的功能与 more 指令类似，但是比 more 指令更加强大，支持各种显示终端</p>
<p>less 指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率。</p>
<p>基本语法：less   [要查看的文件]</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>空格</td>
<td>向下翻动一页</td>
</tr>
<tr>
<td>[pagedown]</td>
<td>向下翻动一页</td>
</tr>
<tr>
<td>[pageup]</td>
<td>向上翻动一页</td>
</tr>
<tr>
<td>&#x2F;  字串</td>
<td>向下搜寻[字串]     n  -  向下查找  N  -  向上查找</td>
</tr>
<tr>
<td>?  字串</td>
<td>向下搜寻[字串]     n  -  向上查找  N  -  向下查找</td>
</tr>
<tr>
<td>q</td>
<td>离开less这个程序</td>
</tr>
</tbody></table>
<br>

<br>

<h3 id="echo-输出内容到控制台"><a href="#echo-–-输出内容到控制台" class="headerlink" title="echo – 输出内容到控制台"></a>echo – 输出内容到控制台</h3><p>基本：echo   [选项]   [输出内容]</p>
<p>$PATH                     环境变量</p>
<p>$POSTNAME          主机名</p>
<p>…</p>
<p>eg.</p>
<ol>
<li>使用 echo 指令输出环境变量                   echo $PATH</li>
<li>使用 echo 指令输出 hello,world!             echo “hello,world!”</li>
</ol>
 <br>

 <br>

<h3 id="head-显示文件的开头部分"><a href="#head-–-显示文件的开头部分" class="headerlink" title="head – 显示文件的开头部分"></a>head – 显示文件的开头部分</h3><p>默认情况下 head 指令显示文件的前10 行内容</p>
<p>基本语法：</p>
<p>head   [文件]</p>
<p>head   -n   x   [文件]        表示显示文件前 x 行，x可以是任何的数字</p>
 <br>

 <br>

<h3 id="tail-显示文件的开头部分"><a href="#tail-–-显示文件的开头部分" class="headerlink" title="tail – 显示文件的开头部分"></a>tail – 显示文件的开头部分</h3><p>默认情况下 tail 指令显示文件的最后10 行内容</p>
<p>基本语法：</p>
<p>head   [文件]</p>
<p>head   -n   x   [文件]        表示显示文件最后x行，x可以是任何的数字</p>
<p>head   -f   [文件]              表示实时追踪该文档的所有更新</p>
 <br>

 <br>

<h3 id="gt和-gtgt-输出重定向和追加"><a href="#gt-和-gt-gt-–-输出重定向和追加" class="headerlink" title="&gt;和 &gt;&gt;   – 输出重定向和追加"></a>&gt;和 &gt;&gt;   – 输出重定向和追加</h3><p>基本语法：</p>
<p>Is   -l   &gt;   文件                         列表的内容写入文件a.txt中(覆盖写)</p>
<p>ls   -al   &gt;&gt;   文件                     列表的内容追加到文件aa.txt的末尾</p>
<p>cat   文件1   &gt;   文件2             将文件1的内容覆盖到文件2</p>
<p>echo   “内容”   &gt;&gt;   文件         将字符串内容追加到指定文件中</p>
<p>eg.</p>
<ol>
<li><p>将 &#x2F;home 目录下的文件列表写入到 &#x2F;home&#x2F;info.txt 中，覆盖写入</p>
<ul>
<li>ls   -l   &#x2F;home   &gt;   &#x2F;home&#x2F;info.txt	[若无info.txt，则会创建]</li>
</ul>
</li>
<li><p>将当前日历信息追加到 &#x2F;home&#x2F;mycal 文件中</p>
<ul>
<li>cal   &gt;&gt;   &#x2F;home&#x2F;mycal （cal – 显示当前日历信息）</li>
</ul>
</li>
</ol>
 <br>

 <br>

<h3 id="ln-软链接"><a href="#ln-–-软链接" class="headerlink" title="ln   –  软链接"></a>ln   –  软链接</h3><p>也称为符号链接，类似于 windows 里的快捷方式，主要存放了连接其他文件的路径</p>
<p>基本语法：ln   -s   [原文件或目录]   [软连接名]               给原文件创建了一个软链接</p>
<p>eg.</p>
<ol>
<li>在 &#x2F;home目录下创建一个软连接 myroot，连接到 &#x2F;root<ul>
<li>ln   -s   &#x2F;root &#x2F;home&#x2F;myroot</li>
</ul>
</li>
<li>删除软连接 myroot <ul>
<li>rm   &#x2F;home&#x2F;myroot</li>
</ul>
</li>
</ol>
<p>PS：当我们使用 pwd 指令查看目录时，仍然看到的是软链接所在目录</p>
 <br>

 <br>

<h3 id="history-查看已经执行过的历史命令"><a href="#history-–-查看已经执行过的历史命令" class="headerlink" title="history – 查看已经执行过的历史命令"></a>history – 查看已经执行过的历史命令</h3><p>也可以执行历史命令</p>
<p>基本语法：history</p>
<p>eg.</p>
<ol>
<li>显示所有的历史命令                     history</li>
<li>显示最近使用过的10 个指令        history 10</li>
<li>执行历史编号为5的指令                !5</li>
</ol>
<br>

<h2 id="54-时间日期"><a href="#5-4-时间日期" class="headerlink" title="5.4 时间日期"></a>5.4 时间日期</h2><h3 id="date-显示当前的日期"><a href="#date-–-显示当前的日期" class="headerlink" title="date – 显示当前的日期"></a>date – 显示当前的日期</h3><p>基本语法：</p>
<p>date                  显示当前时间</p>
<p>date  +%Y        显示当前年份</p>
<p>date  +%m       显示当前月份</p>
<p>date  +%d        显示当前是哪一天</p>
<p>date  “+%Y-%m-%d  %H:%M:%S”             显示年月日时分秒</p>
 <br>

 <br>

<h3 id="date-设置日期"><a href="#date-–-设置日期" class="headerlink" title="date – 设置日期"></a>date – 设置日期</h3><p>基本语法：date   -s   字符串表示的时间</p>
<p>eg.  将系统的当前时间设置为 2020-11-03  20:02:10            date   -s   “2020-11-03   20:02:10”</p>
 <br>

<br>

<h3 id="cal-查看当前的日历信息"><a href="#cal-–-查看当前的日历信息" class="headerlink" title="cal – 查看当前的日历信息"></a>cal – 查看当前的日历信息</h3><p>基本语法：cal   [选项]           不加选项的话就默认显示本月的日历</p>
<p>eg.  显示2020年日历             cal   2020</p>
<br>

<h2 id="55-搜索查找"><a href="#5-5-搜索查找" class="headerlink" title="5.5 搜索查找"></a>5.5 搜索查找</h2><h3 id="find-查找文件x2f目录"><a href="#find-–-查找文件-x2F-目录" class="headerlink" title="find – 查找文件&#x2F;目录"></a>find – 查找文件&#x2F;目录</h3><p>find 指令将从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端</p>
<p>基本语法：find   [搜索范围]   [选项]</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-name&lt;查询方式&gt;</td>
<td>按照指定的文件名查找模式查找文件</td>
</tr>
<tr>
<td>-user&lt;用户名&gt;</td>
<td>查找属于指定用户名所有的文件</td>
</tr>
<tr>
<td>-size&lt;文件大小&gt;</td>
<td>按照指定的文件大小查找文件</td>
</tr>
</tbody></table>
<p>eg.  查找整个 linux 系统下所有大于 200M 的文件           find   &#x2F;   -size   +200M</p>
<p>PS：+n大于    -n小于    n等于，单位有 k，M，G</p>
<br>

<br>

<h3 id="locate-快速定位文件的路径"><a href="#locate-–-快速定位文件的路径" class="headerlink" title="locate – 快速定位文件的路径"></a>locate – 快速定位文件的路径</h3><p>locate 指令利用事先建立的系统中所有文件名称及路径的 locate 数据库实现快速定位给定的文件</p>
<p>Locate 指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新 locate 时刻。</p>
<p>基本语法：locate   [文件]</p>
<p>PS：由于 locate 指令基于数据库进行查找（速度很快），所以第一次运行之前，必须使用 updatedb 指令创建 locate 数据库</p>
<p>eg. 请使用 locate 指令快速定位 hello.txt 文件的位置</p>
<ul>
<li>updatedb</li>
<li>locate   hello.txt</li>
</ul>
<br>

<br>

<h3 id="which-可以查看某个指令在哪个目录下"><a href="#which-–-可以查看某个指令在哪个目录下" class="headerlink" title="which – 可以查看某个指令在哪个目录下"></a>which – 可以查看某个指令在哪个目录下</h3><p>基本语法：which   [指令]</p>
<p>eg.  查看 ls 指令在哪个文件下           which   ls</p>
 <br>

<br>

<h3 id="grep-和"><a href="#grep-和" class="headerlink" title="grep 和 |"></a>grep 和 |</h3><p>grep 过滤查找，常常与 ‘|’ 一起使用，’|’ 为管道符，表示将前一个命令的处理结果输出传送给后面的指令处理。</p>
<p>基本语法：grep   [选项]   查找内容   源文件</p>
<p>常用选项：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-v</td>
<td>反向匹配，只选择不匹配的行</td>
</tr>
<tr>
<td>-n</td>
<td>显示匹配行及行号</td>
</tr>
<tr>
<td>-i</td>
<td>忽略字母大小写</td>
</tr>
</tbody></table>
<p>eg. </p>
<ol>
<li>在 shan.java 文件中查找 “main”，并显示其行号<ul>
<li>grep   -n   “main”   &#x2F;home&#x2F;shan.java </li>
<li>cat   &#x2F;home&#x2F;shan.java   |   grep   -n   “main”</li>
</ul>
</li>
<li>在 shan.java 文件中查找 “main”，显示其行号并且不区分大小写<ul>
<li>grep   -n   -i   “main”   &#x2F;home&#x2F;shan.java</li>
<li>cat   shan.java   |   grep   -n   -i   “main”</li>
</ul>
</li>
<li>在 abc 中不选择 a<ul>
<li>grep   -v   “a”</li>
</ul>
</li>
</ol>
<p>PS：-n  -i  可以缩写为  -ni  或者  -in</p>
<br>

<h3 id="gzip-压缩文件-gunzip-解压"><a href="#gzip-–-压缩文件-gunzip-–-解压" class="headerlink" title="gzip – 压缩文件 gunzip – 解压"></a>gzip – 压缩文件 gunzip – 解压</h3><p>基本语法：</p>
<p>gzip   [文件]                     压缩文件，只能将文件压缩为*.gz文件</p>
<p>gunzip   [文件.gz]           解压缩文件</p>
<p>eg.</p>
<ol>
<li><p>gzip 压缩,将 &#x2F;home 下的 shan.java 文件进行压缩</p>
<ul>
<li>gzip   &#x2F;home&#x2F;shan.java</li>
</ul>
</li>
<li><p>gunzip 解压，将 &#x2F;home 下的 shan.java.gz 文件进行解压缩</p>
<ul>
<li>gunzip   &#x2F;home&#x2F;shan.java.gz</li>
</ul>
</li>
</ol>
<br>

<br>

<h3 id="zip-压缩文件-unzip-解压"><a href="#zip-–-压缩文件-unzip-–-解压" class="headerlink" title="zip – 压缩文件 unzip – 解压"></a>zip – 压缩文件 unzip – 解压</h3><p>这个指令在项目打包发布时很常用</p>
<p>基本语法：</p>
<p>zip   [选项]   要压缩的内容</p>
<p>unzip   [选项]   要解压的内容</p>
<ul>
<li>zip 常用选项</li>
</ul>
<p>​	-r    递归压缩，即压缩目录</p>
<ul>
<li>unzip的常用选项</li>
</ul>
<p>​	-d  [目录]    指定解压后文件的存放目录</p>
<p>eg.</p>
<ol>
<li><p>将 &#x2F;home&#x2F;bbb 下的所有文件&#x2F;文件夹进行压缩成 myhome.zip</p>
<ul>
<li>zip   -r   myhome.zip   &#x2F;home&#x2F;bbb&#x2F;</li>
</ul>
</li>
<li><p>将 mybbb.zip 解压到 &#x2F;opt&#x2F;tmp 目录下</p>
<ul>
<li>mkdir   &#x2F;opt&#x2F;tmp</li>
<li>unzip   -d   &#x2F;opt&#x2F;tmp   &#x2F;home&#x2F;mybbb.zip</li>
</ul>
</li>
</ol>
<br>

<br>

<h3 id="tar-打包"><a href="#tar-–-打包" class="headerlink" title="tar – 打包"></a>tar – 打包</h3><p>可以压缩可以解压，根据选项而定，最后打包的文件是 .tar.gz 的文件</p>
<p>基本语法： tar   [选项]   XXX.tar.gz   打包的内容</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-C</td>
<td>解压到指定位置</td>
</tr>
<tr>
<td>-c</td>
<td>产生.tar打包文件</td>
</tr>
<tr>
<td>-v</td>
<td>显示详细信息</td>
</tr>
<tr>
<td>-f</td>
<td>指定压缩后的文件名</td>
</tr>
<tr>
<td>-z</td>
<td>打包同时压缩</td>
</tr>
<tr>
<td>-x</td>
<td>解包.tar文件</td>
</tr>
</tbody></table>
<p>eg.</p>
<ol>
<li><p>压缩个文件，将 &#x2F;home&#x2F;pig.txt  和 &#x2F;home&#x2F;cat.txt 压缩成 pc.tar.gz</p>
<ul>
<li>tar   -zcvf   pc.tar.gz   &#x2F;home&#x2F;pig.txt   &#x2F;home&#x2F;cat.txt</li>
</ul>
</li>
<li><p>将 &#x2F;home 的文件夹压缩成 myhome.tar.gz </p>
<ul>
<li>tar   -zcvf   myhome.tar.gz   &#x2F;home&#x2F;</li>
</ul>
</li>
<li><p>将 pc.tar.gz 解压到当前目录</p>
<ul>
<li>tar   -zxvf   pc.tar.gz</li>
</ul>
</li>
<li><p>将 myhome.tar.gz 解压到 &#x2F;opt&#x2F;tmp2 目录下</p>
<ul>
<li>mkdir   &#x2F;opt&#x2F;tmp2 </li>
<li>tar   -zxvf   &#x2F;home&#x2F;myhome.tar.gz   -C   &#x2F;opt&#x2F;tmp2</li>
</ul>
</li>
</ol>
<br>

<h1 id="6-组管理和权限管理"><a href="#6-组管理和权限管理" class="headerlink" title="6 组管理和权限管理"></a>6 组管理和权限管理</h1><h2 id="61-组的介绍"><a href="#6-1-组的介绍" class="headerlink" title="6.1 组的介绍"></a>6.1 组的介绍</h2><p>在 linux 中的每个用户必须属于一个组，不能独立于组外。在 linux 中每个文件有所有者、所在组、其它组的概念。</p>
<br>

<p><strong>（1）文件&#x2F;目录 的所有者</strong></p>
<p>一般为文件的创建者，谁创建了该文件，就自然的成为该文件的所有者</p>
<br>

<p><strong>（2）文件&#x2F;目录 的所在组</strong></p>
<p>当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组（默认）</p>
<br>

<p><strong>（3）文件&#x2F;目录 的其他组</strong></p>
<p>除文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组</p>
<br>

<h3 id="用户-的所在组"><a href="#用户-的所在组" class="headerlink" title="用户 的所在组"></a>用户 的所在组</h3><p>在添加用户时，可以指定将该用户添加到哪个组中，同样的用 root 的管理权限可以改变某个用户所在的组</p>
<p><strong>改变用户所在组</strong></p>
<p>usermod   -g   [新组名]   [用户名]</p>
<p>usermod   -d   [目录名]   [用户名]          改变用户登录的初始目录</p>
<br>

<h2 id="62-权限的介绍"><a href="#6-2-权限的介绍" class="headerlink" title="6.2 权限的介绍"></a>6.2 权限的介绍</h2><p>ls   -l 中显示的内容如下:</p>
<p>-rwxrw-r–    1    root    root    1213    Feb  2  09:39    abc</p>
<p>0 - 9 位：</p>
<p>第 0 位确定文件类型（d，l，c，b）</p>
<p>​    l 是链接，相当于 windows 的快捷方式</p>
<p>​    d 是目录，相当于 windows 的文件夹</p>
<p>​    c 是字符设备文件，鼠标，键盘</p>
<p>​    b 是块设备，比如硬盘</p>
<p>第 1 - 3 位确定该文件的所有者拥有的权限                   – User</p>
<p>第 4 - 6 位确定该文件的所在组拥有的权限                   – Group</p>
<p>第 7 - 9 位确定其他用户拥有该文件的权限                   – Other</p>
<br>

<p>1            文件：硬链接数            目录：子目录数</p>
<p>root      所有者</p>
<p>root      所在组</p>
<p>1213     文件大小（单位是字节，为目录时显示4096）</p>
<p>Feb  2  09:39     文件的最后修改日期</p>
<p>abc       文件名</p>
<br>

<p><strong>rwx 作用到文件</strong></p>
<p>[ r ] 代表可读（read）： 可以读取，查看</p>
<p>[ w ] 代表可写（write）： 可以修改，但是不可以删除该文件。删除一个文件的前提条件是对该文件所在的目录有写的权限</p>
<p>[ x ] 代表可执行（execute）：可以被执行</p>
<br>

<p><strong>rwx 作用到目录</strong></p>
<p>[ r ] 代表可读（read）： 可以读取，ls 查看目录内容</p>
<p>[ w ] 代表可写（write）： 可以修改，对目录下的内容 创建 &#x2F; 删除 &#x2F; 重命名</p>
<p>[ x ] 代表可执行（execute）：可以进入该目录，比如 cd 指令</p>
<br>

<h3 id="chmod-修改权限"><a href="#chmod-–-修改权限" class="headerlink" title="chmod – 修改权限"></a>chmod – 修改权限</h3><p><strong>第一种方式：通过 +、-、&#x3D; 变更权限</strong></p>
<p>u：所有者      g：所在组     o：其他人     a：所有的人</p>
<p>chmod    u&#x3D;rwx,g&#x3D;rx,o&#x3D;x    文件&#x2F;目录名</p>
<br>

<p><strong>第二种方式：通过数字变更权限</strong></p>
<p>权限可以用数字来表示，r &#x3D; 4，w &#x3D; 2，x &#x3D; 1</p>
<p>所以      chmod    u&#x3D;rwx,g&#x3D;rx,o&#x3D;x    文件&#x2F;目录名</p>
<p>相当于  chmod    751    文件&#x2F;目录名</p>
<br>

<h3 id="chown-修改文件所有者"><a href="#chown-–-修改文件所有者" class="headerlink" title="chown – 修改文件所有者"></a>chown – 修改文件所有者</h3><p>修改所有者：chown   newowner   文件&#x2F;目录</p>
<p>修改所有者和所在组：chown   newowner:newgroup   文件&#x2F;目录</p>
<p>-R    如果是目录，则使其下所有子文件或目录递归生效</p>
<br>

<h3 id="chgrp-修改文件所在组"><a href="#chgrp-–-修改文件所在组" class="headerlink" title="chgrp – 修改文件所在组"></a>chgrp – 修改文件所在组</h3><p>修改文件&#x2F;目录 的所在组：chgrp   [组名]   [文件名]</p>
<p>eg. 使用 root 用户创建文件 orange.txt，然后将这个文件的所在组修改到 fruit 组</p>
<ul>
<li>groupadd   fruit</li>
<li>touch   orange.txt</li>
<li>chgrp   fruit   orange.txt</li>
</ul>
<br>

<p>PS：</p>
<p>当我们要对文件夹内的文件进行操作，则必须先拥有对该文件夹的相应操作</p>
<br>

<h1 id="7-定时任务调度"><a href="#7-定时任务调度" class="headerlink" title="7 定时任务调度"></a>7 定时任务调度</h1><p>任务调度：是指系统在某个时间执行的特定的命令或程序</p>
<p>任务调度分类：</p>
<p>系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等</p>
<p>个别用户工作：个别用户可能希望执行某些程序，比如对 mysql 数据库的备份</p>
<br>

<h2 id="71-crontab-进行定时任务的设置"><a href="#7-1-crontab-–-进行定时任务的设置" class="headerlink" title="7.1 crontab – 进行定时任务的设置"></a>7.1 crontab – 进行定时任务的设置</h2><p>  基本语法：crontab   [选项]</p>
<table>
<thead>
<tr>
<th>常见选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-e</td>
<td>编辑 crontab 定时任务</td>
</tr>
<tr>
<td>-l</td>
<td>查询 crontab 任务</td>
</tr>
<tr>
<td>-r</td>
<td>删除当前用户所有的 crontab 任务</td>
</tr>
</tbody></table>
<br>

<p>快速入门</p>
<p>执行 crontab   -e 命令</p>
<p>接着输入任务到调度文件</p>
<p>如：* &#x2F; * * * *   ls   -l   &#x2F;etc&#x2F;   &gt;   &#x2F;tmp&#x2F;to.txt</p>
<p>即：每小时的每分钟执行一次 ls  -l  &#x2F;etc&#x2F;  &gt;  &#x2F;tmp&#x2F;to.txt 命令</p>
<p><strong>五个占位符的说明</strong></p>
<table>
<thead>
<tr>
<th>项目</th>
<th>含义</th>
<th>范围</th>
</tr>
</thead>
<tbody><tr>
<td>第一个 ‘*’</td>
<td>一小时中的第几分钟</td>
<td>0 - 59</td>
</tr>
<tr>
<td>第二个 ‘*’</td>
<td>一天中的第几小时</td>
<td>0 - 23</td>
</tr>
<tr>
<td>第三个 ‘*’</td>
<td>一个月中的第几天</td>
<td>1 - 31</td>
</tr>
<tr>
<td>第四个 ‘*’</td>
<td>一年中的第几个月</td>
<td>1 - 12</td>
</tr>
<tr>
<td>第五个 ‘*’</td>
<td>一周当中的星期几</td>
<td>0 - 7</td>
</tr>
</tbody></table>
<br>

<p><strong>特殊符号的说明</strong></p>
<table>
<thead>
<tr>
<th>特殊符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>代表任何时间。比如第一个 ‘*’ 就代表一小时中每分钟都执行次的意思</td>
</tr>
<tr>
<td>，</td>
<td>代表不连续的时间</td>
</tr>
<tr>
<td>-</td>
<td>代表连续的时间范围</td>
</tr>
<tr>
<td>*&#x2F;n</td>
<td>代表每隔多久执行一次</td>
</tr>
</tbody></table>
<p>比如：</p>
<p>“0  8,12,16  *  *  *”    代表在每天的8点0分, 12点0分, 16点0分都执行命令</p>
<p>“0  5  *  *  1-6”           代表在周一到周六的5点0分执行命令</p>
<p>“*&#x2F;10  *  *  *  *”         代表每隔10分钟就执行遍命令</p>
<br>

<p>案例1：每隔 1 分钟，就将当前的日期信息，追加到 &#x2F;tmp&#x2F;mydate 文件中</p>
<p>（1）crontab   -e</p>
<p>（2）*&#x2F;1   *   *   *   *   date   &gt;&gt;   &#x2F;tmp&#x2F;mydate</p>
<p>案例2：每隔 1 分钟，将当前日期和日历都追加到 &#x2F;home&#x2F;mycal 文件中</p>
<p>（1）vim   &#x2F;home&#x2F;my.sh    写入内容：date   &gt;&gt;   &#x2F;home&#x2F;mycal   和   cal   &gt;&gt; &#x2F;home&#x2F;mycal</p>
<p>（2）给 my.sh 增加执行权限：chmod   u+x   &#x2F;home&#x2F;my.sh</p>
<p>（3）crontab   -e   增加   *&#x2F;1   *   *   *   *   &#x2F;home&#x2F;my.sh</p>
<br>

<p><strong>crond 相关指令</strong></p>
<p>crontab   -r        终止任务调度</p>
<p>crontab   -l        列出当前有哪些任务调度</p>
<p>service   crond   restart        重启任务调度</p>
<br>

<h2 id="72-at-定时任务"><a href="#7-2-at-–-定时任务" class="headerlink" title="7.2 at –  定时任务"></a>7.2 at –  定时任务</h2><p>at 命令是一次性定时计划任务，at 的守护进程 atd 会以后台模式运行，检查作业队列来运行。</p>
<p>默认情况下，atd 守护进程每 60 秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，运行此作业</p>
<p>at 命令是一次性定时计划任务，执行完一个任务后不再执行此任务了</p>
<p>在使用 at 命令的时候，一定要保证 atd 进程的启动，可以使用相关指令来查看</p>
<p>ps   -ef   |   grep   atd            可以检测 atd 是否在运行</p>
<br>

<p>基本语法：at   [选项]   [时间]</p>
<p>Ctrl + D        结束 at 命令的输入（输入两次）</p>
<p>atq               查看系统中没有执行的工作任务</p>
<p>atrm            删除已经设置的任务</p>
<p>artm  4       表示删除编号为 4 的任务</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-m</td>
<td>当指定的任务被完成后，将给用户发送邮件，即使没有标准输出</td>
</tr>
<tr>
<td>-I</td>
<td>atq 的别名</td>
</tr>
<tr>
<td>-d</td>
<td>atrm 的别名</td>
</tr>
<tr>
<td>-v</td>
<td>显示任务将被执行的时间</td>
</tr>
<tr>
<td>-c</td>
<td>打印任务的内容到标准输出</td>
</tr>
<tr>
<td>-V</td>
<td>显示版本信息</td>
</tr>
<tr>
<td>-q &lt;队列&gt;</td>
<td>使用指定的队列</td>
</tr>
<tr>
<td>-f &lt;文件&gt;</td>
<td>从指定文件读入任务而不是从标准输入读入</td>
</tr>
<tr>
<td>-t &lt;时间参数&gt;</td>
<td>以时间参数的形式提交要运行的任务</td>
</tr>
</tbody></table>
<p><strong>关于指定时间的说明</strong></p>
<p>接受在当天的 hh:mm 式的时间指定。假如该时间已过去，那么就放在第二天执行</p>
<p>使用 midnight (深夜)，noon (中午)，teatime (饮茶时间，一般是下午4点) 等比较模糊的词语来指定时间</p>
<p>采用12小时计时制，即在时间后面加上AM (上午) 或 PM (下午) 来说明是上午还是下午</p>
<p>指定命令执行的具体日期，指定格式为 month day 或 mm&#x2F;dd&#x2F;yy 或 dd.mm.yy，指定的日期必须跟在指定时间的后面。例如: 04:00 2021-03-1 </p>
<p>使用相对计时法。指定格式为：now + count time-units，now 就是当前时间，time-units 是时间单位，这里能够是 minutes、hours、days、weeks。count 是时间的数量，几天，几小时。例如: now + 5 minutes</p>
<p>直接使用 today、tomorrow来指定完成命令的时间</p>
<br>

<p>eg. 2 天后的下午 5 点执行 &#x2F;bin&#x2F;ls   &#x2F;home</p>
<p>at   5pm   +   2   days     [回车]</p>
<p>&#x2F;bin&#x2F;ls   &#x2F;home               [两次 Ctrl + D]</p>
<br>

<h1 id="8-磁盘分区-挂载"><a href="#8-磁盘分区、挂载" class="headerlink" title="8 磁盘分区、挂载"></a>8 磁盘分区、挂载</h1><h2 id="81-linux-分区"><a href="#8-1-Linux-分区" class="headerlink" title="8.1 Linux 分区"></a>8.1 Linux 分区</h2><p>Linux 来说无论有几个分区，分给哪一个目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构，Linux 中每个分区都是用来组成整个文件系统的一部分</p>
<p>Linux 采用了一种叫 “载入” 的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得</p>
<br>

<p><strong>硬盘说明</strong></p>
<p>Linux 硬盘分 IDE 硬盘和 SCSI 硬盘，目前基本上是 SCSI 硬盘</p>
<br>

<p>对于 IDE 硬盘，驱动器标识符为 “hdx~”，其中 “hd” 表明分区所在设备的类型，这里是指 IDE 硬盘了。</p>
<p>“x” 为盘号（a 为基本盘，b 为基本从属盘，c 为辅助主盘，d 为辅助从属盘）</p>
<p>“~” 代表分区，前四个分区用数字 1 到 4 表示，它们是主分区或扩展分区，从 5 开始就是逻辑分区。</p>
<p>例，hda3 表示为第一个 IDE 硬盘上的第三个主分区 或 扩展分区</p>
<p>hdb2 表示为第二个 IDE 硬盘上的第二个主分区 或 扩展分区</p>
<br>

<p>对于 SCSI 硬盘则标识为 “sdx~”，SCSI 硬盘是用 “sd” 来表示分区所在设备的类型的，其余则和IDE 硬盘的表示方法一样</p>
<br>

<h3 id="查看所有设备的挂载情况"><a href="#查看所有设备的挂载情况" class="headerlink" title="查看所有设备的挂载情况"></a>查看所有设备的挂载情况</h3><p>指令：lsblk     或者     lsblk   -f</p>
<br>

<h2 id="82-挂载的案例"><a href="#8-2-挂载的案例" class="headerlink" title="8.2 挂载的案例"></a>8.2 挂载的案例</h2><p><strong>如何增加一块硬盘？</strong></p>
<p>1）虚拟机添加硬盘</p>
<p>2）分区</p>
<p>3）格式化</p>
<p>4）挂载</p>
<p>5）设置可以自动挂载</p>
<h3 id="增加一块硬盘"><a href="#增加一块硬盘" class="headerlink" title="增加一块硬盘"></a>增加一块硬盘</h3><p>1）</p>
<p>在【虚拟机】菜单中，选择【设置】，然后设备列表里添加硬盘，然后一路【下一步】，中间只有选择磁盘大小的地方需要修改，至到完成。然后重启系统</p>
<p>2）</p>
<p>分区命令：fdisk    &#x2F;dev&#x2F;sdb         开始对 &#x2F;sdb 分区</p>
<p>m       显示命令列表</p>
<p>P        显示磁盘分区    同    fdisk   -l</p>
<p>n        新增分区</p>
<p>d        删除分区</p>
<p>w       写入并退出</p>
<p>q        不保存直接退出</p>
<p>PS：开始分区后输入 n，新增分区，然后选择p，分区类型为主分区。两次回车默认剩余全部空间。最后输入 w 写入分区并退出，若不保存退出输入 q</p>
<p>3）</p>
<p>格式化磁盘</p>
<p>分区命令：mkfs   -t   ext4   &#x2F;dev&#x2F;sdb1 </p>
<p>其中 ext4 是分区类型</p>
<p>4）</p>
<p>挂载：将一个分区与一个目录联系起来</p>
<p>mount   [设备名称]   [挂载目录]</p>
<p>eg. mount    &#x2F;dev&#x2F;sdb1    &#x2F;newdisk</p>
<p>卸载：将一个分区与一个目录断连</p>
<p>umount   [设备名称]  或者  [挂载目录]</p>
<p>eg. umount    &#x2F;dev&#x2F;sdb1  或者  umount    &#x2F;newdisk</p>
<p>PS：用命令行挂载，重启后会失效</p>
<p>5）</p>
<p>永久挂载：通过修改 &#x2F;etc&#x2F;fstab 实现挂载</p>
<p>添加完成后执行 mount  -a 即刻生效</p>
<h2 id="83-磁盘情况查询"><a href="#8-3-磁盘情况查询" class="headerlink" title="8.3 磁盘情况查询"></a>8.3 磁盘情况查询</h2><h3 id="查询系统整体磁盘的使用情况"><a href="#查询系统整体磁盘的使用情况" class="headerlink" title="查询系统整体磁盘的使用情况"></a>查询系统整体磁盘的使用情况</h3><p>基本语法：df   -h</p>
<br>

<h3 id="查询指定目录的磁盘占用情况"><a href="#查询指定目录的磁盘占用情况" class="headerlink" title="查询指定目录的磁盘占用情况"></a>查询指定目录的磁盘占用情况</h3><p>基本语法：du -h</p>
<p>查询指定目录的磁盘占用情况，默认为当前目录</p>
<p>-s    指定目录占用大小汇总.</p>
<p>-h    带计量单位</p>
<p>-a    含文件</p>
<p>–max-depth&#x3D;1    子目录深度</p>
<p>-c    列出明细的同时，增加汇总值</p>
<p>eg. 查询 &#x2F;opt 目录的磁盘占用情况，深度为1</p>
<p>du   -hac   –max-depth&#x3D;1   &#x2F;opt</p>
<br>

<h2 id="84-工作实用指令"><a href="#8-4-工作实用指令" class="headerlink" title="8.4 工作实用指令"></a>8.4 工作实用指令</h2><p>统计 &#x2F;opt 文件夹下文件的个数         ls   -l   &#x2F;opt   |   grep   “^-“   |   wc   -l</p>
<p>统计 &#x2F;opt 文件夹下目录的个数         ls   -l   &#x2F;opt   |   grep   “^d”   |   wc   -l</p>
<p>统计 &#x2F;opt 文件夹下文件的个数，包括子文件夹里的               ls   -lR   &#x2F;opt   |   grep   “^-“   |   wc   -l</p>
<p>统计 &#x2F;opt 文件夹下目录的个数，包括子文件夹里的               ls   -lR   &#x2F;opt   |   grep   “^d”   |   wc   -l</p>
<p>以树状显示目录结构 tree 目录     tree   [目录名]</p>
<p>PS：如果没有tree，则使用 yum install tree 安装</p>
<br>

<h1 id="9-网络配置"><a href="#9-网络配置" class="headerlink" title="9 网络配置"></a>9 网络配置</h1><h2 id="91-nat-网络原理"><a href="#9-1-NAT-网络原理" class="headerlink" title="9.1 NAT 网络原理"></a>9.1 NAT 网络原理</h2><p>查看 windows 环境的中 VMnet8 网络配置：ipconfig</p>
<p>查看 linux 环境中的网络配置：ifconfig</p>
<br>

<h3 id="ping-测试主机之间网络连通性"><a href="#ping-–-测试主机之间网络连通性" class="headerlink" title="ping – 测试主机之间网络连通性"></a>ping – 测试主机之间网络连通性</h3><p>基本语法：ping   [目的主机]</p>
<p>eg. 测试当前服务器是否可以连接百度           ping   <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></p>
<br>

<h2 id="92-linux-网络环境配置"><a href="#9-2-linux-网络环境配置" class="headerlink" title="9.2 linux 网络环境配置"></a>9.2 linux 网络环境配置</h2><p><strong>第一种方法（自动获取）</strong></p>
<p>登陆后，通过界面的来设置自动获取 ip</p>
<p>特点： linux 启动后会自动获取 IP，优点是方便，缺点是每次自动获取的 ip 地址可能不一样</p>
<p><strong>第二种方法（指定 ip）</strong><br>直接修改配置文件来指定 IP，并可以连接到外网</p>
<p>vim   &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</p>
<p><strong>ifcfg-ens33   文件说明：</strong></p>
<p>DEVICE&#x3D;eth0                                            #接口名（设备，网卡）</p>
<p>HWADDR&#x3D;00:0C:2x:6x:0x:xx                 #MAC 地址</p>
<p>TYPE&#x3D;Ethernet                                        #网络类型（通常是 Ethemet）</p>
<p>UUID&#x3D;926a57ba-92c6-4231-bacb-f27e5e6a9f44                  #随机 id</p>
<p>#系统启动的时候网络接口是否有效（yes &#x2F; no）</p>
<p>ONBOOT&#x3D;yes</p>
<p>IP 的配置方法[nonelstatic|bootp|dhcp] （引导时不使用协议|静态分配IP|BOOTP协议|DHCP协议）</p>
<br>

<p>要求：将 ip 地址配置的静态的，比如：ip 地址为 192.168.200.130</p>
<p>（1）BOOTPROTO&#x3D;static（网络连接方式为指定 ip 地址）</p>
<p>（2）指定 ip 地址、网关、域名解释器</p>
<p>​        #IP地址</p>
<p>​        IPADDR&#x3D;192.168.200.130</p>
<p>​        #网关</p>
<p>​        GATEWAY&#x3D;192.168.200.2</p>
<p>​        #域名解析器</p>
<p>​        DNS1&#x3D;192.1 68.200.2</p>
<p>（3）在虚拟器设置中修改 VMnet8 的子网 ip</p>
<p>（4）重启网络服务或者重启系统生效           service   network   restart  或者 reboot</p>
<br>

<h2 id="93-设置主机名和-hosts-映射"><a href="#9-3-设置主机名和-hosts-映射" class="headerlink" title="9.3 设置主机名和 hosts 映射"></a>9.3 设置主机名和 hosts 映射</h2><p>为了方便记忆，可以给 linux 系统设置主机名，也可以根据需要修改主机名</p>
<p>基本语法：hostname   查看主机名</p>
<p>修改文件在 &#x2F;etc&#x2F;hostname 指定。修改后，重启生效</p>
<br>

<p><strong>设置 hosts 映射</strong></p>
<p>思考：如何通过主机名能够找到（比如ping）某个linux系统？</p>
<p>windows 环境下：</p>
<p>在 C:\Windows\System32\drivers\etc\hosts 文件指定即可</p>
<p>案例：192.168.200.128   firtree01</p>
<p>linux 环境下：</p>
<p>在 &#x2F;etc&#x2F;hosts 文件指定</p>
<p>案例：192.168.200.1   LAPTOP-HTKFCLVA</p>
<br>
**Hosts** 

<p>一个文本文件，用来记录 IP 和 Hostname（主机名）的映射关系</p>
<p><strong>DNS</strong></p>
<p>就是 Domain Name System 的缩写，即域名系统。是互联网上作为域名和 IP 地址相互映射的一个分布式数据库</p>
<br>

<p>应用实例：用户在浏览器输入了 www. baidu.com</p>
<p>1）浏览器先检查浏览器缓存中有没有该域名解析 IP 地址，有就先调用这个 IP 完成解析。如果没有，就检查 DNS 解析器缓存，如果有直接返回 IP 完成解析。这两个缓存，可以理解为本地解析器缓存</p>
<p>2）一般来说，当电脑第一次成功访问某一个网站后，在一定时间内，浏览器或操作系统会缓存他的 IP 地址（DNS解析记录）如在 cmd 窗口中输入</p>
<p>​    ipconfig   &#x2F;displaydns      &#x2F;&#x2F; DNS 域名解析缓存<br>​    ipconfig   &#x2F;flushdns         &#x2F;&#x2F; 手动清理 DNS 缓存</p>
<p>3）如果本地解析器缓存没有找到对应映射，检查系统中 hosts 文件中有没有配置对应的域名 IP 映射，如果有，则完成解析并返回</p>
<p>4）如果本地 DNS 解析器缓存和 hosts 文件中均没有找到对应的 IP，则到域名服务 DNS 进行解析</p>
<br>

<h1 id="10-进程管理"><a href="#10-进程管理" class="headerlink" title="10 进程管理"></a>10 进程管理</h1><p><strong>基本介绍</strong></p>
<p>在LINUX中，每个执行的程序都称为一个进程。每一个进程都分配一个ID号（pid，进程号）</p>
<p>每个进程都可能以两种方式存在。前台与后台，所谓前台进程就是用户目前的屏幕上可以进行操作的。后台进程则是实际在操作，但屏幕上无法看到</p>
<p>一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中。直到关机才才结束。</p>
<br>

<h3 id="ps-显示系统执行的进程"><a href="#ps-–-显示系统执行的进程" class="headerlink" title="ps – 显示系统执行的进程"></a>ps – 显示系统执行的进程</h3><p>基本语法：ps</p>
<p>ps 命令是用来查看目前系统中，有哪些正在执行，以及它们执行的状况。可以不加任何参数</p>
<p><strong>ps显示的信息选项：</strong></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>PID</td>
<td>进程识别号</td>
</tr>
<tr>
<td>TTY</td>
<td>终端机号</td>
</tr>
<tr>
<td>TIME</td>
<td>此进程消耗CPU时间</td>
</tr>
<tr>
<td>CMD</td>
<td>正在执行的命令或者进程名</td>
</tr>
</tbody></table>
<p><strong>ps 可选参数：</strong></p>
<p>ps   -a     显示当前终端的所有进程信息</p>
<p>ps   -u     以用户的格式显示进程信息</p>
<p>ps   -x     显示后台进程运行的参数</p>
<p>ps   -e     显示当前的所有进程</p>
<p>ps   -f      全格式</p>
<p><strong>ps 详解</strong></p>
<p>指令：ps   -aux|grep   xxx</p>
<p>说明：</p>
<p>USER：用户名称</p>
<p>PID：进程号</p>
<p>%CPU：进程占用 CPU 的百分比</p>
<p>%MEM：进程占用物理内存的百分比</p>
<p>VSZ：进程占用的虚拟内存大小（单位: KB）</p>
<p>RSS：进程占用的物理内存大小（单位: KB）</p>
<p>TT：终端名称，缩写</p>
<p>STAT：进程状态，其中 S - 睡眠，s - 表示该进程是会话的先导进程，N - 表示进程拥有比普通优先级更低的优先级，R - 正在运行，D - 短期等待，Z - 僵死进程，T - 被跟踪或者被停止等</p>
<p>STARTED：进程的启动时间</p>
<p>TIME：CPU 时间，即进程使用CPU的总时间</p>
<p>COMMAND：启动进程所用的命令和参数，如果过长会被截断显示</p>
<br>

<p><strong>ps   -ef  则表示以全格式显示当前的所有进程</strong></p>
<p>UID：用户ID</p>
<p>PID：进程ID</p>
<p>PPID：父进程ID</p>
<p>C：CPU用于计算执行优先级的因子。数值越大，表明进程是 CPU 密集型运算，执行优先级会降低；数值越小，表明进程是 I&#x2F;O 密集型运算，执行优先级会提高</p>
<p>STIME：进程启动的时间</p>
<p>TTY：完整的终端名称</p>
<p>TIME： CPU 时间</p>
<p>CMD：启动进程所用的命令和参数</p>
<br>

<h3 id="终止进程"><a href="#终止进程" class="headerlink" title="终止进程"></a>终止进程</h3><p>若是某个进程执行一半需要停止时，或是已消了很大的系统资源时，此时可以考虑停止该进程。使用kill命令来完成此项任务</p>
<p><strong>基本语法：</strong></p>
<p>kill   [选项]   [进程号]      通过进程号杀死&#x2F;终止进程</p>
<p>killall   [进程名称]           通过进程名杀死&#x2F;终止进程，此时该进程的子进程也会被终止，也支持通配符，系统负载很大时较为有用</p>
<p><strong>常用选项：</strong></p>
<p>-9    表示强迫进程立即停止</p>
<p>eg. 踢掉某个非法用户</p>
<ul>
<li>ps  -aux  |  grep  sshd            得到用户登录的进程号</li>
<li>kill   [得到的进程号]                 终止进程</li>
</ul>
<br>

<h3 id="pstree-查看进程树"><a href="#pstree-–-查看进程树" class="headerlink" title="pstree – 查看进程树"></a>pstree – 查看进程树</h3><p>基本语法：pstree   [选项]         可以更加直观的查看进程信息</p>
<p>常用选项：</p>
<p>-p    显示进程的 PID</p>
<p>-u    显示进程的所属用户</p>
<br>

<h1 id="11-服务管理"><a href="#11-服务管理" class="headerlink" title="11 服务管理"></a>11 服务管理</h1><p>服务本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其它程序的请求</p>
<p>比如（mysqld，sshd，防火墙等）因此我们又称为守护进程，是Linux中非常重要的知识点</p>
<br>

<h2 id="111-service-服务管理指令"><a href="#11-1-service-服务管理指令" class="headerlink" title="11.1 service 服务管理指令"></a>11.1 service 服务管理指令</h2><p>（1）service   服务名   [start | stop | restart | reload I status]</p>
<p>（2）在 CentOS7.0 后很多服务不再使用 service，而是 systemctl</p>
<p>（3）service 指令管理的服务在 &#x2F;etc&#x2F;init.d 查看</p>
<br>

<h3 id="查看服务名"><a href="#查看服务名" class="headerlink" title="查看服务名"></a>查看服务名</h3><p>方式一：使用 setup 查看系统服务</p>
<p>方式二：在 &#x2F;etc&#x2F;init.d 下可以看到 service 指令管理的服务</p>
<br>

<h2 id="112-服务的运行级别"><a href="#11-2-服务的运行级别" class="headerlink" title="11.2 服务的运行级别"></a>11.2 服务的运行级别</h2><p>Linux 有 7 种运行级别，常用的级别是 3 和 5</p>
<p>运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动</p>
<p>运行级别1：单用户工作状态，root 权限，用于系统维护，禁止远程登陆</p>
<p>运行级别2：多用户状态（没有NFS）不支持网络</p>
<p>运行级别3：完全的多用户状态（有NFS）无界面，登陆后进入控制台命令行模式</p>
<p>运行级别4：系统未使用，保留</p>
<p>运行级别5： X11 控制台，登陆后进入图形 GUI 模式</p>
<p>运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动</p>
<br>

<h3 id="默认的运行级别"><a href="#默认的运行级别" class="headerlink" title="默认的运行级别"></a>默认的运行级别</h3><p>在 centos7 以前，存储在 &#x2F;etc&#x2F;inittab 文件中</p>
<p>之后做了简化：</p>
<p>multi-user.target:ansalogous   to   runlevel   3</p>
<p>grapjical.target:ansalogous   to   runlevel   5</p>
 <br>

<ul>
<li><p>查看当前的运行级别         systemctl   get-default</p>
</li>
<li><p>设置默认的运行级别         systemctl   set-default   TARGET.target</p>
</li>
</ul>
<br>

<h3 id="chkconfig-指令"><a href="#chkconfig-指令" class="headerlink" title="chkconfig 指令"></a>chkconfig 指令</h3><p>通过 chkconfig 命令可以给服务的各个运行级别设置自启动&#x2F;关闭</p>
<p>chkconfig 指令管理的服务在 &#x2F;etc&#x2F;init.d 查看</p>
<p>注意：Centos7.0 后，很多服务使用 systemctl 管理</p>
<br>

<p>chkconfig 基本语法：</p>
<p>（1）查看服务    chkconfig    –list  [|  grep  xxx]</p>
<p>（2）chkconfig    服务名    –list</p>
<p>（3）chkconfig    –level    5    服务名    on&#x2F;off</p>
<p>PS：chkconfig 重新设置服务后自启动或关闭，需要重启机器reboot生效</p>
<br>

<h3 id="systemctl-指令"><a href="#systemctl-指令" class="headerlink" title="systemctl 指令"></a>systemctl 指令</h3><p>基本语法：systemctl    [start I stop | restart I status]    服务名<br>systemctl 指令管理的服务在 &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system 查看</p>
<br>

<p><strong>systemctl 设置服务的自启动状态</strong></p>
<p>systemctl   list-unit-files   [| grep   服务名]       查看服务开机启动状态，grep进行过滤</p>
<p>systemctl   enable   服务名                                  设置服务开机启动</p>
<p>systemctl   disable   服务名                                  关闭服务开机启动</p>
<p>systemctl   is-enabled   服务名                            查询某个服务是否是自启动的</p>
<p>eg. 查看防火墙服务的开机启动状态     systemctl   list-unit-files  |  grep   firewalld</p>
 <br>

<p>关闭或者启用防火墙后，立即生效</p>
<p>但这种方式只是临时生效，当重启系统后，还是回归以前对服务的设置</p>
<p>如果希望设置某个服务自启动或关闭永久生效，要使用systemctl   [enable&#x2F;disable]   服务名</p>
<br>

<h2 id="113-打开x2f关闭端口"><a href="#11-3-打开-x2F-关闭端口" class="headerlink" title="11.3 打开&#x2F;关闭端口"></a>11.3 打开&#x2F;关闭端口</h2><p>在真正的生产环境，往往需要将防火墙打开，但如果我们把防火墙打开，那么外部请求数据包就不能跟服务器监听端口通讯。这时，需要打开指定的端口。比如80、22、8080 等。</p>
<h3 id="firewall-指令"><a href="#firewall-指令" class="headerlink" title="firewall 指令"></a>firewall 指令</h3><p>（1）打开端口：firewall-cmd   –permanent   –add-port&#x3D;端口号&#x2F;协议</p>
<p>（2）关闭端口：firewall-cmd   –permanent   –remove-port&#x3D;端口号&#x2F;协议</p>
<p>（3）重新载入，才能生效：firewall-cmd   –reload</p>
<p>（4）查询端口是否开放：firewall-cmd   –query-port&#x3D;端口号&#x2F;协议</p>
<p>PS：可以通过 netstat   -anp  |  more 查看端口号&#x2F;协议</p>
<br>

<h2 id="114-动态监控进程"><a href="#11-4-动态监控进程" class="headerlink" title="11.4 动态监控进程"></a>11.4 动态监控进程</h2><p>top 与 ps 命令很相似。它们都用来显示正在执行的进程。</p>
<p>top 与 ps 最大的不同之处，在于 top 在执行段时间可以更新正在运行的的进程</p>
<p>基本语法：top   [选项]</p>
<p>常用选项：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-d  秒数</td>
<td>指定 top 命令每几秒更新，默认是 3 秒</td>
</tr>
<tr>
<td>-i</td>
<td>使 top 不显示任何闲置或者僵死进程</td>
</tr>
<tr>
<td>-p</td>
<td>通过指定监控进程ID来仅仅监控某个进程的状态</td>
</tr>
</tbody></table>
<br>

<p>交互操作说明：</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>以CPU使用率排序，默认就是此选项</td>
</tr>
<tr>
<td>M</td>
<td>以内存的使用率排序</td>
</tr>
<tr>
<td>N</td>
<td>以PID排序</td>
</tr>
<tr>
<td>q</td>
<td>退出top</td>
</tr>
</tbody></table>
<br>

<p>（1）监视特定用户，比如 tom 用户</p>
<ul>
<li>top   进入查看进程页面</li>
<li>u    再输入要查看的用户</li>
</ul>
<p>（2）终止指定的进程</p>
<ul>
<li>top   进入查看进程页面</li>
<li>k     再输入要结束的进程 ID 号</li>
</ul>
<br>

<h2 id="115-监控网络信息"><a href="#11-5-监控网络信息" class="headerlink" title="11.5 监控网络信息"></a>11.5 监控网络信息</h2><h3 id="netastat-查看系统网络状态"><a href="#netastat-–-查看系统网络状态" class="headerlink" title="netastat – 查看系统网络状态"></a>netastat – 查看系统网络状态</h3><p>基本语法：netstat   [选项]</p>
<p>常用选项：</p>
<p>-an   按一定顺序排列输出</p>
<p>-p      显示哪一个进程在调用</p>
<p>eg. 请查看服务名为 sshd 的服务的信息              netstat   -anp  |  grep   sshd</p>
<br>

<h1 id="12-rpm-和-yum"><a href="#12-RPM-和-YUM" class="headerlink" title="12 RPM 和 YUM"></a>12 RPM 和 YUM</h1><h2 id="121-rpm-包"><a href="#12-1-rpm-包" class="headerlink" title="12.1 rpm 包"></a>12.1 rpm 包</h2><p>rpm 用于互联网下载包的打包及安装工具，它包含在某些 Linux 分发版中。它生成具有.RPM扩展名的文件</p>
<p>RPM是 RedHat Package Manager（RedHat 软件包管理工具）的缩写，类似 windows 的setup.exe，这一文件格式名称虽然打上了 RedHat 的标志，但理念是通用的</p>
<p>Linux 的分发版本都有采用（suse，redhat，centos等）可以算是公认的行业标准了</p>
<br>

<h3 id="rpm-包的简单查询指令"><a href="#rpm-包的简单查询指令" class="headerlink" title="rpm 包的简单查询指令"></a>rpm 包的简单查询指令</h3><p>基本语法：rpm   -qa  l  grep   XX                 查询已安装的 rpm 列表</p>
<p>eg. 查看当前系统是否安装了firefox             rpm   -qa  |  grep   firefox</p>
<br>

<h3 id="rpm-包名基本格式"><a href="#rpm-包名基本格式" class="headerlink" title="rpm 包名基本格式"></a>rpm 包名基本格式</h3><p>一个 rpm 包名：firefox-68.10.0-1.el7.centos.x86_64</p>
<p>名称：firefox</p>
<p>版本号：68.10.0-1</p>
<p>适用操作系统：el7.centos.x86_64</p>
<p>表示 centos7.x 的 64 位系统</p>
<p>i686、i386 表示 32 位系统，noarch 表示通用</p>
<br>

<h3 id="rpm-包的其他查询指令"><a href="#rpm-包的其他查询指令" class="headerlink" title="rpm 包的其他查询指令"></a>rpm 包的其他查询指令</h3><p>rpm   -qa：查询所安装的所有 rpm 软件包</p>
<p>rpm   -qa  |  more<br>rpm   -qa  |  grep   XXX</p>
<br>

<p>rpm   -q    软件包名：查询软件包是否安装</p>
<p>rpm   -qi   软件包名：查询软件包信息</p>
<p>rpm   -ql   软件包名：查询软件包中的文件</p>
<p>rpm   -qf   文件全路径名：查询文件所属的软件包</p>
<br>

<h3 id="卸载-rpm-包"><a href="#卸载-rpm-包" class="headerlink" title="卸载 rpm 包"></a>卸载 rpm 包</h3><p>基本语法：rpm   -e   RPM   [包的名称]</p>
<p>eg. 删除 firefox 软件包           rpm   -e   firefox</p>
<p><strong>PS：</strong></p>
<p>（1）如果其它软件包依赖于您要卸载的软件包，卸载时则会产生错误信息</p>
<p>（2）如果我们就是要删除 foo 这个 rpm 包，可以增加参数  –nodeps，就可以强制删除，但是一般不推荐这样做， 因为依赖于该软件包的程序可能无法运行</p>
<br>

<h3 id="安装-rpm-包"><a href="#安装-rpm-包" class="headerlink" title="安装 rpm 包"></a>安装 rpm 包</h3><p>基本语法：rpm   -ivh   [RPM包路径名称]</p>
<p>说明：</p>
<p>i &#x3D; intall         安装</p>
<p>v &#x3D; verbose   提示</p>
<p>h &#x3D; hash        进度条</p>
<br>

<h2 id="122-yum-包"><a href="#12-2-yum-包" class="headerlink" title="12.2 yum 包"></a>12.2 yum 包</h2><p> Yum 是一个 Shell 前端软件包管理器。基于 RPM 包管理，能够从指定的服务器自动<br>下载 RPM 包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包</p>
<br>

<h3 id="yum-基本指令"><a href="#yum-基本指令" class="headerlink" title="yum 基本指令"></a>yum 基本指令</h3><p>yum   list  |  grep   xx   [软件列表]          查询 yum 服务器是否有需要安装的软件</p>
<p>yum   install   XXX                 下载安装指定的 yum 包</p>
<p>eg. 下载并安装 firefox</p>
<p>rpm   -e   firefox</p>
<p>yum   list  |  grep   firefox</p>
<p>yum   install   firefox</p>
<br>

<h1 id="12-shell"><a href="#12-Shell" class="headerlink" title="12 Shell"></a>12 Shell</h1><h2 id="121-shell-脚本"><a href="#12-1-shell-脚本" class="headerlink" title="12.1 shell 脚本"></a>12.1 shell 脚本</h2><p>Shell 是一个命令行解释器，它为用户提供了一个向 Linux 内核发送请求以便运行程序的界面系统级程序，用户可以 用 Shell 来启动、挂起、停止甚至是编写一些程序</p>
<br>

<p><strong>脚本格式要求</strong> </p>
<p>（1）脚本以 #!&#x2F;bin&#x2F;bash 开头</p>
<p>（2）脚本需要有可执行权限</p>
<br>

<p><strong>编写第一个 Shell 脚本</strong></p>
<p>需求说明：创建一个 Shell 脚本，输出 hello world! </p>
<p>vim   hello.sh</p>
<p>#!&#x2F;bin&#x2F;bash</p>
<p>echo   “hello,world~”</p>
<br>

<p><strong>脚本的常用执行方式</strong> </p>
<p>方式一：(输入脚本的绝对路径或相对路径)</p>
<p>说明：首先要赋予 helloworld.sh 脚本的 +x 权限， 再执行脚本</p>
<p>比如 .&#x2F;hello.sh 或者使用绝对路径 &#x2F;root&#x2F;shcode&#x2F;hello.sh</p>
<p>方式二：(sh + 脚本)</p>
<p>说明：不用赋予脚本+x 权限，直接执行即可</p>
<p>比如 sh   hello.sh，也可以使用绝对路径</p>
<br>

<h2 id="122-shell-变量"><a href="#12-2-shell-变量" class="headerlink" title="12.2 shell 变量"></a>12.2 shell 变量</h2><p><strong>Shell 变量介绍</strong> </p>
<p>（1）Linux Shell 中的变量分为，系统变量和用户自定义变量</p>
<p>（2）系统变量：$HOME、$PWD、$SHELL、$USER 等等，比如：echo   $HOME 等</p>
<p>（3）显示当前 shell 中所有变量：set</p>
<br>

<p><strong>shell 变量的定义</strong> </p>
<p>基本语法</p>
<p>（1）定义变量：变量名&#x3D;值</p>
<p>（2）撤销变量：unset   变量</p>
<p>（3）声明静态变量：readonly   变量（此时不能 unset）</p>
<p><strong>PS：shell 里不要打空格</strong></p>
<br>

<p><strong>shell 定义变量的规则</strong> </p>
<p>（1）变量名称可以由字母、数字和下划线组成，但是不能以数字开头</p>
<p>（2）等号两侧不能有空格</p>
<p>（3）变量名称一般习惯为大写， 这是一个规范，我们遵守即可</p>
<br>

<p><strong>将命令的返回值赋给变量</strong> </p>
<p>（1） A&#x3D;`date&#96;反引号，运行里面的命令，并把结果返回给变量 A</p>
<p>（2）A&#x3D;$(date)    等价于反引</p>
<br>

<h2 id="123-设置环境变量"><a href="#12-3-设置环境变量" class="headerlink" title="12.3 设置环境变量"></a>12.3 设置环境变量</h2><p><strong>基本步骤：</strong></p>
<p>（1）export   变量名&#x3D;变量值 （功能描述：将 shell 变量输出为环境变量&#x2F;全局变量）</p>
<p>（2）source   配置文件           （功能描述：让修改后的配置信息立即生效）</p>
<p>（3）echo   $变量名                （功能描述：查询环境变量的值）</p>
<br>

<p>eg. </p>
<p>（1）在 &#x2F;etc&#x2F;profile 文件中定义 TOMCAT_HOME 环境变量</p>
<ul>
<li><p>vim   &#x2F;etc&#x2F;profile</p>
</li>
<li><p>在文件最后加上 export   TOMCAT_HOME&#x3D;&#x2F;etc&#x2F;tomcat</p>
</li>
<li><p>source   &#x2F;etc&#x2F;profile               刷新</p>
</li>
<li><p>echo   $TOMCAT_HOME       测试</p>
</li>
</ul>
<br>

<p><strong>shell 语法里的注释</strong></p>
<p>#                    （单行注释）</p>
<p>:&lt;&lt;!  内容  !   （多行注释）</p>
<br>

<h2 id="124-位置参数变量"><a href="#12-4-位置参数变量" class="headerlink" title="12.4 位置参数变量"></a>12.4 位置参数变量</h2><p>当我们执行一个 shell 脚本时，如果希望获取到命令行的参数信息，就可以使用到位置参数变量</p>
<p><strong>基本语法：</strong></p>
<p>$n （n 为数字）</p>
<p>$0 代表命令本身，$1 - $9 代表第一到第九个参数，十以上的参数需要用大括号包含，如${10}） </p>
<p>$* （这个变量代表命令行中所有的参数，$* 把所有的参数看成一个整体）</p>
<p>$@（这个变量也代表命令行中所有的参数，但是 $@ 把每个参数区分对待） </p>
<p>$#（这个变量代表命令行中所有参数的个数）</p>
<br>

<h2 id="125-预定义变量"><a href="#12-5-预定义变量" class="headerlink" title="12.5 预定义变量"></a>12.5 预定义变量</h2><p>就是 shell 设计者事先已经定义好的变量，可以直接在 shell 脚本中使用</p>
<br>

<p>$$ （当前进程的进程号（PID））</p>
<p>$! （后台运行的最后一个进程的进程号（PID））</p>
<p>$?（最后一次执行的命令的返回状态。如果这个变量的值为 0，证明上一个命令正确执行；否则，证明上一个命令执行不正确）</p>
<br>

<h2 id="126-运算符"><a href="#12-6-运算符" class="headerlink" title="12.6 运算符"></a>12.6 运算符</h2><p>（1） “$((运算式))”  或  “$[运算式]”  或  expr  m + n</p>
<p>（2）注意 expr 运算符间要有空格，如果希望将 expr 的结果赋给某个变量，使用 &#96;&#96;</p>
<p>（3）expr  m - n</p>
<p>（4）expr    \*， &#x2F;，% 乘，除，取余</p>
<br>

<p><em><em>一、计算（2+4）</em> 3</em>*</p>
<p>方式一：RES1&#x3D;$(((2+4)*3))</p>
<p>方式二：RES2&#x3D;$[(2+4)*3]</p>
<p>方式三：</p>
<p>TMP&#x3D;`expr   2  +  4&#96;</p>
<p>RES3&#x3D;`expr   $TMP    \*  3&#96;</p>
<p><strong>二、计算命令行的两个参数之和</strong></p>
<p>SUM&#x3D;$(($1+$2))</p>
<p>echo “SUM&#x3D;”$SUM</p>
<br>

<h1 id="13-shell流程控制"><a href="#13-shell流程控制" class="headerlink" title="13 shell流程控制"></a>13 shell流程控制</h1><h2 id="131-条件判断"><a href="#13-1-条件判断" class="headerlink" title="13.1 条件判断"></a>13.1 条件判断</h2><p>基本语法</p>
<p>[ condition ]（注意 condition 前后要有空格） </p>
<p>非空返回 true，可使用 $? 验证（0 为 true，非0 为 false）</p>
<p>[ condition ]   &amp;&amp;   echo   OK   ||   echo   notok          条件满足就执行后面的语句</p>
<br>

<p><strong>常用的判断条件：</strong></p>
<p>（1） &#x3D; 字符串比较 </p>
<p>（2）两个整数的比较</p>
<p>-lt     小于</p>
<p>-le    小于等于     little equal</p>
<p>-eq   等于</p>
<p>-gt    大于</p>
<p>-ge   大于等于</p>
<p>-ne   不等于 </p>
<p>（3）按照文件权限进行判断</p>
<p> -r   有读的权限</p>
<p>-w   有写的权限</p>
<p>-x   有执行的权限</p>
<p>（4）按照文件类型进行判断</p>
<p>-f    文件存在并且是一个常规的文件</p>
<p>-e   文件存在</p>
<p>-d   文件存在并是一个目录</p>
<br>

<h2 id="132-if-语句"><a href="#13-2-if-语句" class="headerlink" title="13.2 if 语句"></a>13.2 if 语句</h2><p><strong>基本语法：</strong></p>
<p>if   [ 条件判断式 ]</p>
<p>then 代码</p>
<p>fi</p>
<p><strong>多分支语法：</strong></p>
<p>if   [ 条件判断式 ]</p>
<p>then</p>
<p>代码</p>
<p>elif   [条件判断式]</p>
<p>then</p>
<p>代码</p>
<p>fi</p>
<br>

<h2 id="133-case-语句"><a href="#13-3-case-语句" class="headerlink" title="13.3 case 语句"></a>13.3 case 语句</h2><p><strong>基本语法：</strong> </p>
<p>case   $变量名   in</p>
<p>“值 1”)</p>
<p>如果变量的值等于值 1，则执行程序 1</p>
<p>;;</p>
<p>“值 2”)</p>
<p>如果变量的值等于值 2，则执行程序 2</p>
<p>;;</p>
<p>…省略其他分支…</p>
<p>*)</p>
<p>如果变量的值都不是以上的值，则执行此程序</p>
<p>;;</p>
<p>esac</p>
<br>

<h2 id="134-for-循环"><a href="#13-4-for-循环" class="headerlink" title="13.4 for 循环"></a>13.4 for 循环</h2><p> <strong>基本语法1：</strong> </p>
<p>for   变量   in   值1   值2   值3… </p>
<p>do</p>
<p>程序&#x2F;代码</p>
<p>done</p>
<p>eg.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span><br><span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;now = &quot;</span><span class="hljs-variable">$i</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>

<br>

<p><strong>基本语法2：</strong> </p>
<p>for   (( 初始值；循环控制条件；变量变化 ))</p>
<p>do</p>
<p>程序&#x2F;代码</p>
<p>done</p>
<p><strong>eg. 求 1 - 100 的和</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>SUM=0<br><span class="hljs-keyword">for</span> (( i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">100</span>; i++ ))<br><span class="hljs-keyword">do</span><br>        SUM=$[<span class="hljs-variable">$SUM</span>+<span class="hljs-variable">$i</span>]<br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;SUM = &quot;</span><span class="hljs-variable">$SUM</span>                 <br></code></pre></td></tr></table></figure>

<br>

<h2 id="135-while-循环"><a href="#13-5-while-循环" class="headerlink" title="13.5 while 循环"></a>13.5 while 循环</h2><p><strong>基本语法：</strong></p>
<p>while   [ 条件判断式 ]</p>
<p>do</p>
<p>程序&#x2F;代码</p>
<p>done</p>
<p><strong>eg. 求 1 - 输入值 的和</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>SUM=0<br>i=0<br><br><span class="hljs-keyword">while</span> [ <span class="hljs-variable">$i</span> -le <span class="hljs-variable">$1</span> ]<br><span class="hljs-keyword">do</span><br>        SUM=$[<span class="hljs-variable">$SUM</span>+<span class="hljs-variable">$i</span>]<br>        i=$[<span class="hljs-variable">$i</span>+1]<br><span class="hljs-keyword">done</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;SUM = &quot;</span><span class="hljs-variable">$SUM</span><br><br></code></pre></td></tr></table></figure>

<br>

<h2 id="136-read-读取控制台输入"><a href="#13-6-read-读取控制台输入" class="headerlink" title="13.6 read 读取控制台输入"></a>13.6 read 读取控制台输入</h2><p>read（选项）（参数）</p>
<p>选项：</p>
<p>-p       指定读取值时的提示符</p>
<p>-t        指定读取值时等待的时间（秒），如果没有在指定的时间内输入，就不再等待了</p>
<p>参数</p>
<p>变量：指定读取值的变量名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#案例 1：读取控制台输入一个 NUM1 值</span><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;请输入一个数 NUM1=&quot;</span> NUM1<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;你输入的 NUM1=<span class="hljs-variable">$NUM1</span>&quot;</span> <br><br><span class="hljs-comment">#案例 2：读取控制台输入一个 NUM2 值，在 10 秒内输入</span><br><span class="hljs-built_in">read</span> -t 10 -p <span class="hljs-string">&quot;请输入一个数 NUM2=&quot;</span> NUM2<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;你输入的 NUM2=<span class="hljs-variable">$NUM2</span>&quot;</span><br></code></pre></td></tr></table></figure>

<br>

<h1 id="14-shell-函数"><a href="#14-shell-函数" class="headerlink" title="14 shell 函数"></a>14 shell 函数</h1><p>shell 编程和其它编程语言一样，有系统函数，也可以自定义函数</p>
<h2 id="141-系统函数"><a href="#14-1-系统函数" class="headerlink" title="14.1 系统函数"></a>14.1 系统函数</h2><p>basename   – 返回完整路径最后 &#x2F; 的后面部分，常用于获取文件名</p>
<p>基本语法：</p>
<p>basename   [pathname]   [suffix] </p>
<p>basename   [string]   [suffix] </p>
<p>功能描述：basename 命令会删掉所有的前缀包括最后一个 “ &#x2F; ” 字符，然后将字符串显示出来</p>
<p>选项： </p>
<p>suffix 为后缀，如果 suffix 被指定了，basename 会将 pathname 或 string 中的 suffix 去掉</p>
<br>

<p>dirname   – 返回完整路径最后 &#x2F; 的前面的部分，常用于返回路径</p>
<p>基本语法：</p>
<p>dirname   文件绝对路径</p>
<p>功能描述：从给定的包含绝对路径的文件名中去除文件名（非目录的部分），然后返回剩下部分</p>
<br>

<h2 id="142-自定义函数"><a href="#14-2-自定义函数" class="headerlink" title="14.2 自定义函数"></a>14.2 自定义函数</h2><p>基本语法：</p>
<p>[ function ]   funname[()] </p>
<p>{</p>
<p>​        Action;</p>
<p>​        [return int;] </p>
<p>} </p>
<p>调用函数        funname [值]</p>
<p>eg. 计算输入的两个数之和   getSum</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment">#定义函数 getSum</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">getSum</span></span>() &#123;<br>    SUM=$[<span class="hljs-variable">$n1</span>+<span class="hljs-variable">$n2</span>]<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;和是=<span class="hljs-variable">$SUM</span>&quot;</span> <br>&#125;<br><br><span class="hljs-comment">#输入两个值</span><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;请输入一个数 n1=&quot;</span> n1<br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;请输入一个数 n2=&quot;</span> n2<br><br><span class="hljs-comment">#调用自定义函数</span><br>getSum <span class="hljs-variable">$n1</span> <span class="hljs-variable">$n2</span><br></code></pre></td></tr></table></figure>

<br>

<h2 id="143-综合案例"><a href="#14-3-综合案例" class="headerlink" title="14.3 综合案例"></a>14.3 综合案例</h2><p>（1）每天凌晨 2:30 备份数据库 hspedu 到 &#x2F;data&#x2F;backup&#x2F;db</p>
<p>（2）备份开始和备份结束能够给出相应的提示信息</p>
<p>（3）备份后的文件要求以备份时间为文件名，并打包成 .tar.gz 的形式</p>
<p>（4）在备份的同时，检查是否有 10 天前备份的数据库文件，如果有就将其删除</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment">#！/bin/bash</span><br><br><span class="hljs-comment">#备份目录</span><br><span class="hljs-attribute">BACKUP</span>=/data/backup/db<br><br><span class="hljs-comment">#当前时间</span><br><span class="hljs-attribute">DATETIME</span>=$(date +%Y-%m-%d_%H%M%S)<br>echo <span class="hljs-variable">$DATETIME</span><br><br><span class="hljs-comment">#数据库的地址</span><br><span class="hljs-attribute">HOST</span>=localhost<br><br><span class="hljs-comment">#数据库用户名</span><br><span class="hljs-attribute">DB_USER</span>=root<br><br><span class="hljs-comment">#数据库密码</span><br><span class="hljs-attribute">DB_PW</span>=hspedu100<br><br><span class="hljs-comment">#备份的数据库名</span><br><span class="hljs-attribute">DATABASE</span>=hspedu<br><br><span class="hljs-comment">#创建备份目录, 如果不存在，就创建</span><br>[ ! -d <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BACKUP&#125;</span>/<span class="hljs-variable">$&#123;DATETIME&#125;</span>&quot;</span> ] &amp;&amp; mkdir -p <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BACKUP&#125;</span>/<span class="hljs-variable">$&#123;DATETIME&#125;</span>&quot;</span><br><br><span class="hljs-comment">#备份数据库</span><br>mysqldump -u<span class="hljs-variable">$&#123;DB_USER&#125;</span> -p<span class="hljs-variable">$&#123;DB_PW&#125;</span> <span class="hljs-attribute">--host</span>=<span class="hljs-variable">$&#123;HOST&#125;</span> -q -R --databases <span class="hljs-variable">$&#123;DATABASE&#125;</span> | gzip &gt;<br><span class="hljs-variable">$&#123;BACKUP&#125;</span>/<span class="hljs-variable">$&#123;DATETIME&#125;</span>/<span class="hljs-variable">$DATETIME</span>.sql.gz<br><br><span class="hljs-comment">#将文件处理成 tar.gz</span><br>cd <span class="hljs-variable">$&#123;BACKUP&#125;</span><br>tar -zcvf <span class="hljs-variable">$DATETIME</span>.tar.gz <span class="hljs-variable">$&#123;DATETIME&#125;</span><br><br><span class="hljs-comment">#删除对应的备份目录</span><br>rm -rf <span class="hljs-variable">$&#123;BACKUP&#125;</span>/<span class="hljs-variable">$&#123;DATETIME&#125;</span><br><br><span class="hljs-comment">#删除 10 天前的备份文件</span><br><span class="hljs-built_in">find</span> <span class="hljs-variable">$&#123;BACKUP&#125;</span> -atime +10 -name <span class="hljs-string">&quot;*.tar.gz&quot;</span> -exec rm -rf &#123;&#125; \;<br>echo <span class="hljs-string">&quot;备份数据库<span class="hljs-variable">$&#123;DATABASE&#125;</span> 成功~</span><br></code></pre></td></tr></table></figure>

<br>

<p># 每天两点半执行脚本 </p>
<p>crontab  -e</p>
<p>30   2   *   *   *   &#x2F;usr&#x2F;sbin&#x2F;mysql_db_backup.sh</p>
<br>

<br>

<h1 id="15-日志管理"><a href="#15-日志管理" class="headerlink" title="15 日志管理"></a>15 日志管理</h1><p><strong>基本介绍：</strong></p>
<p>日志文件是重要的系统信息文件，其中记录了许多重要的系统事件，包括用户的登录信息、系统的启动信息、系统 的安全信息、邮件相关信息、各种服务相关信息等</p>
<p>日志对于安全来说也很重要，它记录了系统每天发生的各种事情，通过日志来检查错误发生的原因，或者受到攻击 时攻击者留下的痕迹</p>
<p>可以这样理解 日志是用来记录重大事件的工具</p>
<br>

<h2 id="151-系统常用的日志"><a href="#15-1-系统常用的日志" class="headerlink" title="15.1 系统常用的日志"></a>15.1 系统常用的日志</h2><p>&#x2F;var&#x2F;log&#x2F;    目录就是系统日志文件的保存位置</p>
<table>
<thead>
<tr>
<th>日志文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;var&#x2F;log&#x2F;boot.log</td>
<td>系统启动日志</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;cron</td>
<td>记录与系统定时任务相关的日志</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;cups&#x2F;</td>
<td>记录打印信息的日志</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;dmesg</td>
<td>记录了系统在开机时内核自检的信总。也可以使用 dmesg 命令直接查看内核自检信息</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;btmp</td>
<td>记录错误登陆的日志。这个文件是二进制文件，不能直接用 Vi 查看，而要使用 lastb 命令查看。[root@localhost  log]#lastb</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;lastlog</td>
<td>记录系统中所有用户最后一次的登录时间的日志。这个文件也是二进制文件。要使用 lastlog 命令查看</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;maillog</td>
<td>记录邮件信息的日志</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;message</td>
<td>记录系统重要消息的日志，这个日志文件中会记录 Linux 系统的绝大多数重要信息。如果系统出现问题，首先要检查的应该就是这个日志文件</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;secure</td>
<td>记录验证和授权方面的信息，只要涉及账户和密码的程序都会记录，比如系统的登录、ssh的登录、su切换用户甚至添加用户和修改用户密码都会记录在这个日志文件中</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;wtmp</td>
<td>永久记录所有用户的登陆、注销信息，同时记录系统的后动、重启、关机事件。是二进制文件。要使用 last 命令查看</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;run&#x2F;ulmp</td>
<td>记录当前已经登录的用户的信息。这个文件会随着用户的登录和注销而不断变化，只记录当前登录用户的信息。这个文件不能用 Vi 查看，要使用w、who、users等命令查看</td>
</tr>
</tbody></table>
<br>

<h2 id="152-日志管理服务-rsyslogd"><a href="#15-2-日志管理服务-rsyslogd" class="headerlink" title="15.2 日志管理服务 rsyslogd"></a>15.2 日志管理服务 rsyslogd</h2><p>CentOS7.6 日志服务是 rsyslogd ， CentOS6.x 日志服务是 syslogd</p>
<p>rsyslogd 功能更强大。rsyslogd 的使用、日志 文件的格式，和 syslogd 服务是兼容的</p>
<br>

<p><strong>查询 Linux 中的 rsyslogd 服务是否启动</strong></p>
<p>ps   aux   |   grep   “rsyslog”   |   grep   -v   “grep”</p>
<p><strong>查询 rsyslogd 服务的自启动状态</strong></p>
<p>systemctl   list-unit-files   |   grep   rsyslog</p>
<p><strong>配置文件：&#x2F;etc&#x2F;rsyslog.conf</strong></p>
<p>编辑文件时的格式为：* .*        存放日志文件</p>
<p>其中第一个 * 代表日志类型，第二个 * 代表日志级别</p>
<br>

<p><strong>（1）日志类型分为：</strong></p>
<p>auth               ##pam 产生的日志</p>
<p>authpriv        ##ssh、ftp 等登录信息的验证信息</p>
<p>corn               ##时间任务相关</p>
<p>kern               ##内核</p>
<p>lpr                  ##打印</p>
<p>mail               ##邮件</p>
<p>mark(syslog)-rsyslog          ##服务内部的信息，时间标识</p>
<p>news             ##新闻组</p>
<p>user              ##用户程序产生的相关信息 </p>
<p>uucp             ##unix   to   nuix   copy 主机之间相关的通信</p>
<p>local   1-7     ##自定义的日志设备</p>
<p><strong>（2）日志级别分为：</strong></p>
<p>debug           ##有调试信息的，日志通信最多</p>
<p>info               ##一般信息日志，最常用</p>
<p>notice           ##最具有重要性的普通条件的信息</p>
<p>warning       ##警告级别</p>
<p>err                ##错误级别，阻止某个功能或者模块不能正常工作的信息</p>
<p>crit                ##严重级别，阻止整个系统或者整个软件不能正常工作的信息</p>
<p>alert             ##需要立刻修改的信息</p>
<p>emerg          ##内核崩溃等重要信息</p>
<p>none             ##什么都不记录</p>
<p>注意：从上到下，级别从低到高，记录信息越来越少</p>
<br>

<p>由日志服务 rsyslogd 记录的日志文件，日志文件的格式包含以下 4 列</p>
<p>（1）事件产生的时间</p>
<p>（2）产生事件的服务器的主机名  </p>
<p>（3）产生事件的服务名或程序名</p>
<p>（4）事件的具体信息（事件的描述）</p>
<br>

<p><strong>想要创建一个自定义日志</strong></p>
<p>（1）在配置文件 &#x2F;etc&#x2F;rsyslog.conf 中添加描述</p>
<p>​           *.*                                  &#x2F;var&#x2F;log&#x2F;shan.log</p>
<p>（2）新键 &#x2F;var&#x2F;log&#x2F;shan.log 文件</p>
<p>（3）重启</p>
<br>

<h2 id="153-日志轮换"><a href="#15-3-日志轮换" class="headerlink" title="15.3 日志轮换"></a>15.3 日志轮换</h2><p>日志轮替就是把旧的日志文件移动并改名，同时建立新的空日志文件，当旧日志文件超出保存的范围之后，就会进行删除</p>
<br>

<p><strong>日志轮替文件命名</strong></p>
<p>（1）centos7 使用 logrotate 进行日志轮替管理，要想改变日志轮替文件名字，通过 &#x2F;etc&#x2F;logrotate.conf 配置文件中 “dateext” 参数</p>
<p>（2）如果配置文件中有 “dateext” 参数，那么日志会用日期来作为日志文件的后缀，例如 “secure-20201010”。这样日志文件名不会重叠，也就不需要日志文件的改名， 只需要指定保存日志个数，删除多余的日志文件即可</p>
<p>（3）如果配置文件中没有 “dateext” 参数，日志文件就需要进行改名了。</p>
<p>当第一次进行日志轮替时，当前的 “secure” 日志会自动改名为 “secure.1”，然后新建 “secure” 日志，用来保存新的日志。</p>
<p>当第二次进行日志轮替时，“secure.1” 会自动改名为 “secure.2”， 当前的 “secure” 日志会自动改名为 “secure.1”，然后也会新建 “secure” 日志，用来 保存新的日志，以此类推</p>
<br>

<h2 id="154-logrotate-配置文件"><a href="#15-4-logrotate-配置文件" class="headerlink" title="15.4 logrotate 配置文件"></a>15.4 logrotate 配置文件</h2><p>&#x2F;etc&#x2F;logrotate.conf  配置文件说明：</p>
<p># rotate log files weekly，每周对日志文件进行一次轮替 </p>
<p>weekly </p>
<p># keep 4 weeks worth of backlogs，共保存 4 份日志文件，当建立新的日志文件时，旧的将会被删除</p>
<p>rotate 4 </p>
<p># create new (empty) log files after rotating old ones，创建新的空的日志文件，在日志轮替后</p>
<p>create </p>
<p># use date as a suffix of the rotated file，使用日期作为日志轮替文件的后缀</p>
<p>dateext </p>
<p># uncomment this if you want your log files compressed, 日志文件是否压缩。如果取消注释，则日志会在转储的同时进行压缩 </p>
<p>#compress</p>
<p>#RPM packages drop log rotation information into this directory</p>
<p># 包含 &#x2F;etc&#x2F;logrotate.d&#x2F; 目录中所有的子配置文件。也就是说会把这个目录中所有子配置文件读取进来</p>
<p>include &#x2F;etc&#x2F;logrotate.d</p>
<p><strong>#下面是单独设置，优先级更高</strong> </p>
<p># no packages own wtmp and btmp – we’ll rotate them here </p>
<p>&#x2F;var&#x2F;log&#x2F;wtmp { </p>
<p>​        monthly # 每月对日志文件进行一次轮替</p>
<p>​        create 0664 root utmp # 建立的新日志文件，权限是 0664 ，所有者是 root ，所属组是 utmp 组</p>
<p>​        minsize 1M   # 日志文件最小轮替大小是 1MB 。也就是日志一定要超过 1MB 才会轮替，否则就算时间达到 一个月，也不进行日志转储</p>
<p>​        rotate 1         # 仅保留一个日志备份。也就是只有 wtmp 和 wtmp.1 日志保留而已</p>
<p>}</p>
<p>&#x2F;var&#x2F;log&#x2F;btmp {</p>
<p>​        missingok    # 如果日志不存在，则忽略该日志的警告信息</p>
<p>​        monthly</p>
<p>​        create 0600 root utmp</p>
<p>​        rotate 1</p>
<p>}</p>
<br>

<p><strong>参数说明</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数说明</th>
</tr>
</thead>
<tbody><tr>
<td>daily</td>
<td>日志的轮替周期是每天</td>
</tr>
<tr>
<td>weekly</td>
<td>日志的轮替周期是每周</td>
</tr>
<tr>
<td>monthly</td>
<td>日志的轮替周期是每月</td>
</tr>
<tr>
<td>rotate 数字</td>
<td>保留的日志文件的个数。0 指没有备份</td>
</tr>
<tr>
<td>compress</td>
<td>日志轮替时，旧的日志进行压缩</td>
</tr>
<tr>
<td>create mode owner group</td>
<td>建立新日志，同时指定新日志的权限与所有者和所属组</td>
</tr>
<tr>
<td>mail address</td>
<td>当日志轮替时，输出内容通过邮件发送到指定的邮件地址</td>
</tr>
<tr>
<td>missingok</td>
<td>如果日志不存在，则忽略该日志的警告信息</td>
</tr>
<tr>
<td>notifempty</td>
<td>如果日志为空文件，则不进行日志轮替</td>
</tr>
<tr>
<td>minsize 大小</td>
<td>日志轮替的最小值。也就是日志一定要达到这个最小值才会轮替</td>
</tr>
<tr>
<td>size 大小</td>
<td>日志只有大于指定大小才进行日志轮替，而不是按照时间轮替</td>
</tr>
<tr>
<td>dateext</td>
<td>使用日期作为日志轮替文件的后缀</td>
</tr>
<tr>
<td>sharedscripts</td>
<td>在此关键字之后的脚本只执行一次</td>
</tr>
<tr>
<td>prerotate&#x2F;endscript</td>
<td>在日志轮替之前执行脚本命令</td>
</tr>
<tr>
<td>postrotate&#x2F;endscript</td>
<td>在日志轮替之后执行脚本命令</td>
</tr>
</tbody></table>
<p><strong>把自己的日志加入日志轮替</strong></p>
<p>第一种方法是直接在 &#x2F;etc&#x2F;logrotate.conf 配置文件中写入该日志的轮替策略</p>
<p>第二种方法是在 &#x2F;etc&#x2F;logrotate.d&#x2F; 目录中新建立该日志的轮替文件，在该轮替文件中写入正确的轮替策略，因为该目录中的文件都会被 “include” 到主配置文件中，所以也可以把日志加入轮替</p>
<p>推荐使用第二种方法，因为系统中需要轮替的日志非常多，如果全都直接写入&#x2F;etc&#x2F;logrotate.conf 配置文件，那么这个文件的可管理性就会非常差，不利于此文件的维护</p>
<br>

<p>比如要想给 shan 这个日志以第二种方式配置，就在 &#x2F;etc&#x2F;logrotate.d&#x2F; 目录下创建文件 shan</p>
<p>&#x2F;var&#x2F;log&#x2F;shan.log</p>
<p>{</p>
<p>​        missingok</p>
<p>​        daily</p>
<p>​        copytruncate</p>
<p>​        rotate 7</p>
<p>​        notifempty</p>
<p>}</p>
<p><strong>日志轮替机制原理</strong></p>
<p>日志轮替之所以可以在指定的时间备份日志，是依赖系统定时任务。在 &#x2F;etc&#x2F;cron.daily&#x2F; 目录，就会发现这个目录中有 logrotate 文件（可执行），logrotate 通过这个文件依赖定时任务执行的</p>
<br>

<h2 id="155-查看日志内存"><a href="#15-5-查看日志内存" class="headerlink" title="15.5 查看日志内存"></a>15.5 查看日志内存</h2><p>journalctl   –  可以查看内存日志</p>
<p><strong>常用指令：</strong></p>
<p>journalctl                                                                ##查看全部</p>
<p>journalctl   -n   3                                                    ##查看最新 3 条</p>
<p>journalctl   –since   19:00   –until   19:10:10    ##查看起始时间到结束时间的日志</p>
<p>journalctl   -p   err                                                 ##报错日志</p>
<p>journalctl   -o   verbose                                        ##日志详细内容</p>
<p>journalctl_PID&#x3D;1245    _COMM&#x3D;sshd                ##查看包含这些参数的日志（在详细日志查看）</p>
<p>或者 journalctl   |   grep ssh</p>
<br>

<p>PS：journalctl 查看的是内存日志，重启清空</p>
<br>

<h1 id="16-备份与恢复"><a href="#16-备份与恢复" class="headerlink" title="16 备份与恢复"></a>16 备份与恢复</h1><p>实体机无法做快照，如果系统出现异常或者数据损坏，后果严重， 要重做系统，还会造成数据丢失。</p>
<p>所以我们可以使用备份和恢复技术</p>
<p>linux 的备份和恢复很简单，有两种方式： </p>
<p>（1）把需要的文件（或者分区）用 TAR 打包就行，下次需要恢复的时候，再解压开覆盖即可</p>
<p>（2）使用 dump 和 restore 命令</p>
<br>

<p><strong>安装 dump 和 restore</strong></p>
<p>如果 linux 上没有 dump 和 restore 指令，需要先按照</p>
<p>yum   -y   install   dump</p>
<p>yum   -y   install   restore</p>
<br>

<h2 id="161-使用dump-完成备份"><a href="#16-1-使用dump-完成备份" class="headerlink" title="16.1 使用dump 完成备份"></a>16.1 使用dump 完成备份</h2><p>dump 支持分卷和增量备份（所谓增量备份是指备份上次备份后 修改&#x2F;增加过的文件，也称差异备份）</p>
<p><strong>基本语法：</strong></p>
<p>dump    [ -cu]    [-123456789]    [ -f &lt;备份后文件名&gt;]    [-T &lt;日期&gt;]    [ 目录或文件系统]</p>
<p>dump    []-wW</p>
<p>-c ：创建新的归档文件，并将由一个或多个文件参数所指定的内容写入归档文件的开头</p>
<p>-0123456789 ：备份的层级。0 为最完整备份，会备份所有文件。若指定 0 以上的层级，则备份至上一次备份以来 修改或新增的文件，到 9 后，可以再次轮替</p>
<p>-f   &lt;备份后文件名&gt; ：指定备份后文件名</p>
<p>-j ：调用 bzlib 库压缩备份文件，也就是将备份后的文件压缩成 bz2 格式，让文件更小</p>
<p>-T   &lt;日期&gt; ：指定开始备份的时间与日期</p>
<p>-u ：备份完毕后，在&#x2F;etc&#x2F;dumpdares 中记录备份的文件系统，层级，日期与时间等</p>
<p>-t ：指定文件名，若该文件已存在备份文件中，则列出名称</p>
<p>-W ：显示需要备份的文件及其最后一次备份的层级，时间 ，日期</p>
<p>-w ：与-W 类似，但仅显示需要备份的文件</p>
<br>

<p><strong>举例：</strong></p>
<p>（1）将 &#x2F;boot 分区所有内容备份到 &#x2F;opt&#x2F;boot.bak0.bz2 文件中，备份层级为 “0” </p>
<p>​        dump    -0uj    -f    &#x2F;opt&#x2F;boot.bak0.bz2    &#x2F;boot</p>
<p>（2）在 &#x2F;boot 目录下增加新文件，备份层级为 “1”（只备份上次使用层次 “0” 备份后发生过改变的数据）</p>
<p>​        dump    -1uj    -f    &#x2F;opt&#x2F;boot.bak1.bz2    &#x2F;boot</p>
<p>​        PS：通过 dump 命令在配合 crontab 可以实现无人值守备份</p>
<br>

<p><strong>查看备份时间文件</strong></p>
<p>cat   &#x2F;etc&#x2F;dumpdates</p>
<br>

<p><strong>备份文件或者目录</strong></p>
<p>我们在备份分区时，是可以支持增量备份的</p>
<p>但是如果备份文件或者目录，不再支持增量备份，即只能使用 0 级别备份</p>
<p>前面的 -u 指令也不支持，因为不支持层级备份的话，也没有必要记录层级信息</p>
<br>

<p>eg. 使用 dump 备份 &#x2F;etc 整个目录</p>
<p>​    dump   -0j   -f   &#x2F;opt&#x2F;etc.bak.bz2   &#x2F;etc&#x2F;</p>
<p># 下面这条语句会报错，提示 DUMP: Only level 0 dumps are allowed on a subdirectory</p>
<p>​    dump   -1j   -f   &#x2F;opt&#x2F;etc.bak.bz2   &#x2F;etc&#x2F;</p>
<p>PS：如果是重要的备份文件， 比如数据区，建议将文件上传到其它服务器保存</p>
<br>

<h2 id="162-使用-restore-完成恢复"><a href="#16-2-使用-restore-完成恢复" class="headerlink" title="16.2 使用 restore 完成恢复"></a>16.2 使用 restore 完成恢复</h2><p>restore 命令用来恢复已备份的文件，可以从 dump 生成的备份文件中恢复原文件</p>
<p><strong>基本语法：</strong></p>
<p>restore   [模式选项]   [选项]</p>
<p>模式有四个， 不能混用，在一次命令中， 只能指定一种</p>
<p>-C ：使用对比模式，将备份的文件与已存在的文件相互对比</p>
<p>-i ：使用交互模式，在进行还原操作时，restors 指令将依序询问用户</p>
<p>-r ：进行还原模式</p>
<p>-t ：查看模式，看备份文件有哪些文件</p>
<br>

<p>选项</p>
<p>-f   &lt;备份设备&gt;：从指定的文件中读取备份数据，进行还原操作</p>
<br>

<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p>（一）</p>
<p>分析日志 t.log（访问量），将各个 ip 地址截取，并统计出现次数,并按从大到小排序</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.10&#x2F;index1.html</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.10&#x2F;index2.html</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.20&#x2F;index1.html</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.30&#x2F;index1.html</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.40&#x2F;index1.html</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.30&#x2F;order.html</p>
<p>http:&#x2F;&#x2F;<span></span>192.168.200.10&#x2F;order.html</p>
<br>

<p>先创建文件 t.txt，再将内容复制到文件中</p>
<p>cat   t.txt   |   cut   -d   ‘&#x2F;‘   -f   3   |   sort   |   uniq   -c   |  sort   -nr</p>
<p>PS：uniq  -c 是统计相邻行的重复情况，所以要先排序，将相同的 ip 排在一起</p>
<br>

<p>（二）</p>
<p>统计连接到服务器的各个 ip 情况，并按连接数从大到小排序</p>
<p>netstat  -an  |  grep  ESTABLISHED  |  awk  -F  “ “   ‘{print  $5}’  |  cut  -d  “:”  -f  1 | sort | uniq  -c | sort  -nr</p>
<br>

<p>（三）</p>
<p>统计 ip 访问情况，要求分析 nginx 访问日志（access.log），找出访问页面数量在前 2 位的 ip</p>
<p>cat   access.log | awk   -F   “ “   ‘{print $1}’  | sort | uniq   -c | sort   -nr | head  -2</p>
<br>

<p>（四）忘记了 mysql5.7 数据库的 ROOT 用户的密码，如何找回？</p>
<p>​        vim   &#x2F;etc&#x2F;my.cnf</p>
<p>​        添加一句话  skip-grant-tables</p>
<p>​        service   mysqld   restart</p>
<p>​        mysql   -u   root   -p    然后输入空密码即可进入</p>
<p>​        show   databases</p>
<p>​        use   mysql</p>
<p>​        update   user   set   authentication_sring&#x3D;password(“shan”)   where   user&#x3D;’root’</p>
<p>​        flush   privileges;    刷新</p>
<p>​        exit</p>
<p>​        再把之前添加在 &#x2F;etc&#x2F;my.cnf 中的一句话注销，再重启 mysqld 即可</p>
<br>

<p>（五）</p>
<p>使用 tcpdump 监听本机，将来自 ip 192.168.200.1，tcp 端口为 22 的数据，保存输出到 tcpdump.log , 用做将来数据分析</p>
<p>​    tcpdump   -i   ens33   host   192.168.200.1   and   port   22   &gt;&gt;   &#x2F;home&#x2F;tcpdump.log</p>
<br>

<p>（六）常用的 Nginx 模块，用来做什么</p>
<p>rewrite 模块：实现重写功能</p>
<p>access 模块：来源控制</p>
<p>ssl 模块：安全加密</p>
<p>ngx_http_gzip_module：网络传输压缩模块</p>
<p>ngx_http_proxy_module 模块实现代理</p>
<p>ngx_http_upstream_module 模块实现定义后端服务器列表</p>
<p>ngx_cache_purge 实现缓存清除功</p>
<br>

<p>（七）如果你是系统管理员，在进行 Linux 系统权限划分时，应考虑哪些因素</p>
<p>1）首先阐述 Linux 权限的主要对象</p>
<p>2）根据自己实际经验谈考虑因素</p>
<p>​    注意权限分离，比如：工作中，Linux 系统权限和数据库权限不要在同一个部门</p>
<p>​    权限最小原则（即：在满足使用的情况下最少优先）</p>
<p>​    减少使用 root 用户，尽量用普通用户 + sudo 提权进行日常操作</p>
<p>​    重要的系统文件，日常建议使用 chattr（change attribute）锁定, 需要操作时再打开</p>
<p>​    使用 SUID，SGID，Sticky 设置特殊权</p>
<p>​    可以利用工具，比如 chkrootkit&#x2F;rootkit  hunter 检测 rootkit 脚本</p>
<p>​    利用工具 Tripwire 检测文件系统完整性</p>
<br>

<p>（八）列举 Linux 高级命令，至少 6 个</p>
<p>​    netstat  &#x2F;&#x2F;网络状态监控               top &#x2F;&#x2F;系统运行状态        lsblk &#x2F;&#x2F;查看硬盘分区</p>
<p>​    find  ps  -aux  &#x2F;&#x2F;查看运行进程     chkconfig &#x2F;&#x2F;查看服务启动状态     systemctl &#x2F;&#x2F;管理系统服务</p>
<br>

<p>（九）Linux 查看内存、io 读写、磁盘存储、端口占用、进程查看命令是什么</p>
<p>​    top、iotop、df  -  lh、netstat  -  tunlp、ps  -  aux  |  grep</p>
<p>​    yum   install   iotop       有的指令默认是没有的，需要先安装</p>
<br>

<p>（十）使用 Linux 命令计算 t2.txt 第二列的和并输出</p>
<p>​    张三 40</p>
<p>​    李四 50</p>
<p>​    王五 60</p>
<p>​    cat   t2.txt   |   awk   -F   “ “   ‘{sum+&#x3D;$2}   END    {print   sum}’</p>
<br>

<p>（十一）脚本里如何检查一个文件是否存在？并给出提示</p>
<p>​    if   [ -f   文件名 ]   then   echo   “存在”   else   echo   “不存在”   fi</p>
<br>

<p>（十二）用 shell 写一个脚本，对文本 t3.txt 中无序的一列数字排序, 并将总和输出</p>
<p>​    sort   -nr   t3.txt  |  awk  ‘{sum+&#x3D;$0;  print $0}  END  {print   “和&#x3D;”sum}</p>
<br>

<p>（十三）请用指令写出查找当前文件夹（&#x2F;home）下所有的文本文件内容中包含有字符 “ cat” 的文件名称</p>
<p>​    grep   -r   “cat”   &#x2F;home  |  cut  -d   “:”   -f   1</p>
<br>

<p>（十四）统计&#x2F;home 目录下所有文件个数和所有文件总行数的指令</p>
<p>​    find   &#x2F;home&#x2F;test   -name   “*.*“  |  wc   -l</p>
<p>​    find   &#x2F;home&#x2F;test   -name   “*.*“  |  xargs   wc  -l</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Others/" class="category-chain-item">Others</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Linux/">#Linux</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Linux笔记</div>
      <div>http://example.com/post/e511c25d.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>firtree</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年4月8日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/post/79666db.html" title="数据结构（非ACM版）">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">数据结构（非ACM版）</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/post/511433eb.html" title="【题解】CF558_E">
                        <span class="hidden-mobile">【题解】CF558_E</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
